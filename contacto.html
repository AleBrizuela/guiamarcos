<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="theme-color" content="#002147">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Inicio — Medicare Hispano | Medicare Hispano</title>
<meta name="description" content="Medicare Hispano — Susana Marcos y Alejandra Brizuela Marcos. Comparamos planes de Kaiser, SCAN, Humana, Aetna y UnitedHealthcare en California y la Región Central. Siempre gratis. (877) 647-5260">
<meta name="keywords" content="medicare en español, medicare los angeles, agente medicare bilingüe, medicare advantage california, planes medicare los angeles, seguro medicare hispano, bilingual medicare agent california, medicare agent Los Angeles, comparar planes medicare, planes de salud para mayores de 65, medicare hispano">
<link rel="canonical" href="https://medicare-hispano.com/">
<meta property="og:type" content="website">
<meta property="og:title" content="Medicare Made Simple | Susana Marcos LLC | Los Angeles">
<meta property="og:description" content="Susana Marcos y Alejandra Brizuela Marcos — equipo de madre e hija. Comparamos planes de Kaiser, SCAN, Humana, Aetna, UnitedHealthcare. 100% gratuito.">
<meta property="og:url" content="https://medicare-hispano.com/">
<meta property="og:locale" content="es_US">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"InsuranceAgency","name":"Susana Marcos LLC","description":"Bilingual Medicare insurance agency. Independent brokers comparing all carriers at no cost.","url":"https://medicare-hispano.com","telephone":"+18776475260","email":"alejamedicare@gmail.com","address":{"@type":"PostalAddress","addressLocality":"Los Angeles","addressRegion":"CA","addressCountry":"US"},"areaServed":[{"@type":"State","name":"California"},{"@type":"State","name":"Illinois"},{"@type":"State","name":"Texas"},{"@type":"State","name":"Oklahoma"},{"@type":"State","name":"Florida"},{"@type":"State","name":"Iowa"}],"openingHours":"Mo-Fr 07:00-16:00 PST, Sa 08:00-12:00 PST","priceRange":"Free","knowsLanguage":["Spanish","English"],"founder":[{"@type":"Person","name":"Susana Marcos","jobTitle":"JD, MBA — Founder and Principal Agent"},{"@type":"Person","name":"Alejandra Brizuela Marcos","jobTitle":"Licensed Medicare Insurance Agent — Partner"}]}
</script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<style>
:root {
  --navy: #002147;
  --green: #007B40;
  --blue: #1D72B8;
  --teal: #007B7B;
  --mint: #A8D8B9;
  --lt-blue: #D6EAF7;
  --lt-green: #D4EDE1;
  --lt-mint: #EAF6EE;
  --lt-gray: #F0F3F6;
  --gray: #4A5568;
  --dark: #1a202c;
  --white: #FFFFFF;
  --wa-green: #25D366;
  --radius: 12px;
  --shadow: 0 4px 24px rgba(0,60,113,0.10);
  --shadow-lg: 0 8px 40px rgba(0,60,113,0.16);
}

* { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; }
body { font-family: 'Inter', -apple-system, sans-serif; color: var(--dark); font-size: 19px; line-height: 1.8; background: var(--white); }


/* ── CARRIER TRUST BAR ─────────────────────────────────────── */
.carrier-trust-bar {
  padding: 40px 24px;
  background: #F8FAFC;
  border-top: 1px solid #E2E8F0;
  border-bottom: 1px solid #E2E8F0;
}
.trust-bar-label {
  text-align: center; font-size: 13px; color: var(--gray);
  margin-bottom: 28px; letter-spacing: 0.12em;
  text-transform: uppercase; font-weight: 600;
}
.carrier-logos {
  display: flex; flex-wrap: wrap; justify-content: center; gap: 14px;
}
.carrier-pill {
  padding: 11px 24px; border-radius: 32px;
  border: 2px solid var(--brand-color, #D1D5DB);
  font-weight: 700; font-size: 14px;
  font-family: 'Inter', sans-serif;
  background: white; color: #9CA3AF;
  filter: grayscale(100%);
  transition: all 0.3s ease;
  cursor: default; letter-spacing: 0.01em;
  user-select: none;
}
.carrier-pill-img {
  padding: 10px 20px;
  display: flex; align-items: center; justify-content: center;
  min-height: 52px;
  border: 2px solid var(--brand-color, #D1D5DB);
}
.carrier-pill-img img {
  height: 28px; width: auto; display: block;
  filter: grayscale(100%) opacity(50%);
  transition: filter 0.3s ease;
}
.carrier-pill-img:hover img {
  filter: grayscale(0%) opacity(100%);
}
.carrier-pill-img:hover {
  box-shadow: 0 4px 20px rgba(0,0,0,0.13);
  transform: translateY(-3px);
}
.carrier-pill:hover {
  filter: grayscale(0%);
  color: var(--brand-color, var(--navy));
  box-shadow: 0 4px 20px rgba(0,0,0,0.13);
  transform: translateY(-3px);
}
@media (max-width: 768px) {
  .carrier-pill { font-size: 13px; padding: 9px 18px; }
}

/* ── HEADER ─────────────────────────────────────────────── */
.header {
  position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
  background: rgba(255,255,255,0.97); backdrop-filter: blur(8px);
  border-bottom: 2px solid var(--lt-blue);
  transition: box-shadow 0.3s;
}
.header.scrolled { box-shadow: var(--shadow); }
.header-inner {
  max-width: 1200px; margin: 0 auto;
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 24px; height: 70px;
}
.logo {
  font-family: 'Playfair Display', serif; font-size: 22px;
  font-weight: 700; color: var(--navy); text-decoration: none;
}
.logo span { color: var(--green); }
nav { display: flex; align-items: center; gap: 8px; }
nav a {
  text-decoration: none; font-size: 14px; font-weight: 500;
  color: var(--gray); padding: 8px 14px; border-radius: 8px;
  transition: all 0.2s;
}
nav a:hover, nav a.active { color: var(--navy); background: var(--lt-blue); }
.lang-toggle {
  background: none; border: 2px solid var(--navy); color: var(--navy);
  padding: 6px 14px; border-radius: 20px; font-size: 14px;
  font-weight: 600; cursor: pointer; margin-left: 8px;
  transition: all 0.2s; display: flex; align-items: center; gap: 6px;
}
.lang-toggle:hover { background: var(--lt-blue); }
.lang-toggle img { width: 20px; height: 14px; border-radius: 2px; object-fit: cover; }
.mobile-menu-btn {
  display: none; background: none; border: none;
  font-size: 24px; color: var(--navy); cursor: pointer;
}
.phone-header {
  display: flex; align-items: center; gap: 6px;
  color: var(--green); font-weight: 700; font-size: 15px;
  text-decoration: none;
}
.phone-header i { font-size: 16px; }

/* ── WHATSAPP FLOATING ─────────────────────────────────── */
.wa-float {
  position: fixed; bottom: 24px; right: 16px; z-index: 999;
  background: var(--wa-green); color: white;
  height: 48px; border-radius: 28px; padding: 0 18px 0 14px;
  display: flex; align-items: center; gap: 8px;
  font-size: 22px; text-decoration: none; white-space: nowrap;
  box-shadow: 0 4px 20px rgba(37,211,102,0.45);
  transition: transform 0.2s, box-shadow 0.2s;
  animation: pulse-wa 2.5s infinite;
  outline: 2px solid rgba(255,255,255,0.6);
  outline-offset: 2px;
}
.wa-float .float-label {
  font-size: 12px; font-weight: 700; letter-spacing: 0.8px;
  font-family: 'Inter', sans-serif; line-height: 1;
}
.wa-float:hover { transform: scale(1.05); box-shadow: 0 6px 28px rgba(37,211,102,0.55); }
.sms-float {
  position: fixed; bottom: 84px; right: 16px; z-index: 999;
  background: var(--blue); color: white;
  height: 48px; border-radius: 28px; padding: 0 18px 0 14px;
  display: flex; align-items: center; gap: 8px;
  font-size: 20px; text-decoration: none; white-space: nowrap;
  box-shadow: 0 4px 20px rgba(30,136,229,0.4);
  transition: transform 0.2s, box-shadow 0.2s;
  outline: 2px solid rgba(255,255,255,0.6);
  outline-offset: 2px;
}
.sms-float .float-label {
  font-size: 12px; font-weight: 700; letter-spacing: 0.8px;
  font-family: 'Inter', sans-serif; line-height: 1;
}
.sms-float:hover { transform: scale(1.05); box-shadow: 0 6px 28px rgba(30,136,229,0.5); }
@keyframes pulse-wa {
  0%, 100% { box-shadow: 0 4px 20px rgba(37,211,102,0.45); }
  50%      { box-shadow: 0 6px 30px rgba(37,211,102,0.65); }
}

/* ── MOBILE FIRST ────────────────────────────────────────── */
@media (max-width: 768px) {
  /* Hero: stack widget on top, text below */
  .hero-grid { grid-template-columns: 1fr !important; }
  .hero-grid > div:first-child { order: 2; }
  .hero-grid .hero-widget { order: 1; margin-bottom: 20px; }

  /* Hero text sizing */
  .hero h1 { font-size: 28px !important; }
  .hero p { font-size: 15px !important; }
  .hero-ctas { flex-direction: column; gap: 10px; }
  .hero-ctas .btn { width: 100%; justify-content: center; font-size: 16px; padding: 16px; }

  /* Widget */
  .hero-widget { padding: 0 !important; }
  .widget-container { border-radius: 16px !important; padding: 20px 16px !important; }
  .widget-opt { padding: 14px 12px !important; transform: none !important; }
  .widget-opt-icon { width: 48px !important; height: 48px !important; font-size: 20px !important; border-radius: 12px !important; flex-shrink: 0; }
  .widget-opt-text h4 { font-size: 14px !important; }
  .widget-opt-badge { position: absolute; bottom: 8px; right: 10px; font-size: 9px !important; padding: 3px 7px !important; }
  .widget-opt { position: relative; }
  .mobile-sticky-cta { display: flex; }

  /* Nav */
  #desktop-nav { display: none !important; }

  /* Stats bar */
  .stats-grid { grid-template-columns: repeat(2, 1fr) !important; gap: 16px !important; }

  /* Team cards */
  .team-grid { grid-template-columns: 1fr !important; }

  /* Services */
  .services-grid { grid-template-columns: 1fr !important; }
  .medicare-parts { grid-template-columns: 1fr !important; }

  /* CTA banner */
  .cta-banner h2 { font-size: 22px !important; }
  .cta-buttons { flex-direction: column; align-items: center; }
  .cta-buttons .btn { width: 100%; max-width: 320px; justify-content: center; }

  /* Floating buttons */
  .wa-float, .sms-float { right: 12px; }
  .sms-float { bottom: 80px; }

  /* Contact page */
  .contact-methods-grid { grid-template-columns: 1fr !important; }
  .contact-form-grid { grid-template-columns: 1fr !important; }

  /* Footer */
  .footer-grid { grid-template-columns: 1fr !important; }

  /* General sections */
  section { padding: 48px 16px !important; }
  .section-title { font-size: 24px !important; }
}

/* ── SECTIONS ──────────────────────────────────────────── */
section { padding: 80px 24px; }
.container { max-width: 1200px; margin: 0 auto; }
.section-label {
  font-size: 13px; font-weight: 700; letter-spacing: 2px;
  text-transform: uppercase; color: var(--green); margin-bottom: 12px;
}
.section-title {
  font-family: 'Playfair Display', serif; font-size: 40px;
  font-weight: 700; color: var(--navy); line-height: 1.2;
  margin-bottom: 16px;
}
.section-subtitle {
  font-size: 18px; color: var(--gray); max-width: 600px;
  line-height: 1.6;
}

/* ── HERO ──────────────────────────────────────────────── */
.hero {
  padding-top: 140px; padding-bottom: 60px;
  background: linear-gradient(135deg, var(--lt-mint) 0%, var(--lt-blue) 100%);
  position: relative; overflow: hidden;
}
.hero::after {
  content: ''; position: absolute; bottom: -2px; left: 0; right: 0;
  height: 60px; background: white;
  clip-path: ellipse(60% 100% at 50% 100%);
}
.hero-grid {
  display: grid; grid-template-columns: 1fr 1fr; gap: 60px;
  align-items: center;
}
.hero h1 {
  font-family: 'Playfair Display', serif; font-size: 52px;
  font-weight: 700; color: var(--navy); line-height: 1.15;
  margin-bottom: 20px;
}
.hero h1 em {
  font-style: normal; color: var(--green);
  text-decoration: underline; text-decoration-color: var(--mint);
  text-underline-offset: 6px;
}
.hero p { font-size: 19px; color: var(--gray); margin-bottom: 32px; line-height: 1.7; }
.hero-ctas { display: flex; gap: 16px; flex-wrap: wrap; margin-bottom: 32px; }
.btn {
  display: inline-flex; align-items: center; gap: 8px;
  padding: 14px 28px; border-radius: 10px;
  font-size: 16px; font-weight: 600; text-decoration: none;
  transition: all 0.2s; border: none; cursor: pointer;
}
.btn-primary { background: var(--green); color: white; }
.btn-primary:hover { background: #006834; transform: translateY(-1px); box-shadow: var(--shadow); }
.btn-secondary { background: white; color: var(--navy); border: 2px solid var(--navy); }
.btn-secondary:hover { background: var(--navy); color: white; }
.btn-wa { background: var(--wa-green); color: white; }
.btn-wa:hover { background: #1fb855; }
.trust-badges {
  display: flex; gap: 24px; flex-wrap: wrap;
  padding-top: 24px; border-top: 1px solid rgba(0,60,113,0.1);
}
.trust-badge {
  display: flex; align-items: center; gap: 8px;
  font-size: 14px; color: var(--gray);
}
.trust-badge i { color: var(--green); font-size: 18px; }

/* Hero right: Quick Widget Preview */
.hero-widget {
  background: white; border-radius: 20px; padding: 36px;
  box-shadow: var(--shadow-lg); position: relative;
}
.hero-widget h3 {
  font-size: 22px; font-weight: 700; color: var(--navy);
  margin-bottom: 8px; text-align: center;
}
.hero-widget p.widget-sub {
  font-size: 14px; color: var(--gray); text-align: center;
  margin-bottom: 24px;
}
.widget-options { display: flex; flex-direction: column; gap: 12px; }
.widget-opt {
  display: flex; align-items: center; gap: 16px;
  padding: 16px 20px; border-radius: 16px; cursor: pointer;
  border: 2px solid var(--lt-gray);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  background: white;
}
.widget-opt:hover { transform: translateX(8px); border-color: var(--green); background: var(--lt-mint); }
.widget-opt.selected { border-color: var(--green); background: var(--lt-mint); }
.widget-opt-icon {
  width: 44px; height: 44px; border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  font-size: 20px; color: white; flex-shrink: 0;
}
.widget-opt-text h4 { font-size: 15px; font-weight: 600; color: var(--navy); }
.widget-opt-text p { font-size: 13px; color: var(--gray); margin-top: 2px; }
.widget-opt-badge {
  margin-left: auto; padding: 4px 10px; border-radius: 20px;
  font-size: 11px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 0.5px; flex-shrink: 0;
}
.badge-urgent { background: #FEE2E2; color: #DC2626; }
.badge-soon { background: #FEF3C7; color: #D97706; }
.badge-explore { background: var(--lt-blue); color: var(--blue); }
.badge-help { background: var(--lt-green); color: var(--green); }

/* ── STATS BAR ─────────────────────────────────────────── */
.stats-bar {
  background: var(--navy); padding: 40px 24px;
}
.stats-grid {
  max-width: 1200px; margin: 0 auto;
  display: grid; grid-template-columns: repeat(4, 1fr); gap: 32px;
  text-align: center;
}
.stat-item h3 {
  font-family: 'Playfair Display', serif; font-size: 44px;
  font-weight: 700; color: var(--mint);
}
.stat-item p { font-size: 14px; color: var(--lt-blue); margin-top: 4px; }

/* ── SERVICES OVERVIEW ─────────────────────────────────── */
.services-overview { background: white; }
.services-grid {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px;
  margin-top: 40px;
}
.service-card {
  background: var(--lt-gray); border-radius: var(--radius);
  padding: 32px; transition: all 0.3s; border: 2px solid transparent;
}
.service-card:hover { border-color: var(--green); transform: translateY(-4px); box-shadow: var(--shadow); }
.service-card-icon {
  width: 56px; height: 56px; border-radius: 12px;
  display: flex; align-items: center; justify-content: center;
  font-size: 24px; color: white; margin-bottom: 20px;
}
.service-card h3 { font-size: 20px; font-weight: 700; color: var(--navy); margin-bottom: 10px; }
.service-card p { font-size: 15px; color: var(--gray); line-height: 1.6; }

/* ── CTA BANNER ────────────────────────────────────────── */
.cta-banner {
  background: linear-gradient(135deg, var(--navy), var(--blue));
  padding: 60px 24px; text-align: center;
}
.cta-banner h2 {
  font-family: 'Playfair Display', serif; font-size: 36px;
  color: white; margin-bottom: 16px;
}
.cta-banner p { font-size: 18px; color: var(--lt-blue); margin-bottom: 32px; max-width: 600px; margin-left: auto; margin-right: auto; }
.cta-buttons { display: flex; gap: 16px; justify-content: center; flex-wrap: wrap; }

/* ── ABOUT PAGE ────────────────────────────────────────── */
.about-hero {
  padding-top: 140px; padding-bottom: 60px;
  background: linear-gradient(135deg, var(--lt-blue) 0%, var(--lt-mint) 100%);
}
.team-grid {
  display: grid; grid-template-columns: 1fr 1fr; gap: 32px;
  margin-top: 40px;
}
.team-card {
  background: white; border-radius: var(--radius); padding: 40px;
  box-shadow: var(--shadow); text-align: center;
}
/* team avatars now inline */
.team-photo-wrap { width:140px;height:140px;margin:0 auto 20px;position:relative; }
.team-card h3 { font-size: 22px; font-weight: 700; color: var(--navy); margin-bottom: 4px; }
.team-card .role { font-size: 14px; color: var(--teal); font-weight: 600; margin-bottom: 16px; }
.team-card p { font-size: 15px; color: var(--gray); line-height: 1.7; }
.team-card .credentials {
  display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;
  margin-top: 16px;
}
.credential-tag {
  background: var(--lt-gray); padding: 6px 14px; border-radius: 20px;
  font-size: 12px; font-weight: 600; color: var(--navy);
}

/* ── MEDICARE 101 ──────────────────────────────────────── */
.medicare-parts {
  display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px;
  margin-top: 40px;
}
.part-card {
  border-radius: var(--radius); padding: 32px;
  border-left: 5px solid;
}
.part-card h3 { font-size: 20px; font-weight: 700; margin-bottom: 8px; }
.part-card p { font-size: 15px; line-height: 1.7; }

/* ── WIDGET PAGE ───────────────────────────────────────── */
.widget-page { padding-top: 140px; }
.widget-container {
  max-width: 640px; margin: 0 auto; position: relative; overflow: hidden;
  background: white; border-radius: 20px; padding: 48px;
  box-shadow: var(--shadow-lg);
}
.widget-step { display: none; }
.widget-step.active { display: block; }
.widget-progress {
  display: flex; gap: 8px; margin-bottom: 32px;
}
.widget-progress-dot {
  flex: 1; height: 5px; border-radius: 3px;
  background: var(--lt-gray);
}
.widget-progress-dot.filled { background: var(--green); }
.widget-back {
  background: var(--lt-blue); border: 2px solid var(--blue);
  color: var(--blue); font-size: 14px; font-weight: 600;
  cursor: pointer; margin-bottom: 20px;
  display: inline-flex; align-items: center; gap: 8px;
  padding: 8px 16px; border-radius: 20px;
  transition: all 0.2s;
}
.widget-back:hover { background: var(--blue); color: white; }
.widget-q {
  font-size: 24px; font-weight: 700; color: var(--navy);
  margin-bottom: 8px;
}
.widget-qsub { font-size: 15px; color: var(--gray); margin-bottom: 24px; }
.widget-result {
  text-align: center; padding: 20px 0;
}
.widget-result-icon {
  width: 80px; height: 80px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 36px; margin: 0 auto 20px;
}
.widget-result h3 { font-size: 24px; color: var(--navy); margin-bottom: 8px; }
.widget-result p { font-size: 16px; color: var(--gray); margin-bottom: 24px; line-height: 1.7; }
.zip-input {
  width: 100%; padding: 16px 20px; border: 2px solid var(--lt-gray);
  border-radius: 10px; font-size: 18px; text-align: center;
  font-family: 'Inter', sans-serif;
  transition: border-color 0.2s;
}
.zip-input:focus { outline: none; border-color: var(--green); }

/* ── CONTACT PAGE ──────────────────────────────────────── */
.contact-grid {
  display: grid; grid-template-columns: 1fr 1fr; gap: 40px;
  margin-top: 40px;
}
.contact-form { background: var(--lt-gray); border-radius: var(--radius); padding: 36px; }
.contact-form h3 { font-size: 22px; font-weight: 700; color: var(--navy); margin-bottom: 20px; }
.form-group { margin-bottom: 16px; }
.form-group label {
  display: block; font-size: 14px; font-weight: 600;
  color: var(--gray); margin-bottom: 6px;
}
.form-group input, .form-group select, .form-group textarea {
  width: 100%; padding: 12px 16px; border: 2px solid #E2E8F0;
  border-radius: 8px; font-size: 15px; font-family: 'Inter', sans-serif;
  transition: border-color 0.2s;
}
.form-group input:focus, .form-group select:focus, .form-group textarea:focus {
  outline: none; border-color: var(--green);
}
.contact-methods { display: flex; flex-direction: column; gap: 20px; }
.contact-method {
  display: flex; align-items: center; gap: 16px;
  background: white; border-radius: var(--radius); padding: 24px;
  box-shadow: var(--shadow); text-decoration: none; color: inherit;
  transition: transform 0.2s;
}
.contact-method:hover { transform: translateY(-2px); }
.contact-method-icon {
  width: 56px; height: 56px; border-radius: 12px;
  display: flex; align-items: center; justify-content: center;
  font-size: 24px; color: white; flex-shrink: 0;
}
.contact-method h4 { font-size: 16px; font-weight: 700; color: var(--navy); }
.contact-method p { font-size: 14px; color: var(--gray); }

/* ── FOOTER ────────────────────────────────────────────── */
footer {
  background: var(--navy); color: var(--lt-blue); padding: 60px 24px 30px;
}
.footer-grid {
  max-width: 1200px; margin: 0 auto;
  display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 40px;
}
.footer-grid h4 { color: var(--mint); font-size: 14px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 16px; }
.footer-grid a { color: var(--lt-blue); text-decoration: none; font-size: 14px; display: block; margin-bottom: 8px; }
.footer-grid a:hover { color: white; }
.footer-grid p { font-size: 14px; line-height: 1.7; }
.footer-bottom {
  max-width: 1200px; margin: 40px auto 0;
  padding-top: 24px; border-top: 1px solid rgba(255,255,255,0.1);
  font-size: 12px; color: rgba(255,255,255,0.4);
  text-align: center; line-height: 1.6;
}

/* ── PAGE SECTIONS (HIDE/SHOW) ──────────────────────── */
.page { display: none; }
.page.active { display: block; }

/* ── MOBILE ────────────────────────────────────────────── */
.mobile-nav {
  display: none; position: fixed; top: 70px; left: 0; right: 0;
  background: white; padding: 16px; box-shadow: var(--shadow);
  z-index: 999; flex-direction: column; gap: 4px;
}
.mobile-nav.open { display: flex; }

@media (max-width: 900px) {
  nav { display: none; }
  .mobile-menu-btn { display: block; }
  .hero-grid { grid-template-columns: 1fr; gap: 32px; }
  .hero h1 { font-size: 36px; }
  .stats-grid { grid-template-columns: repeat(2, 1fr); }
  .services-grid { grid-template-columns: 1fr; }
  .team-grid { grid-template-columns: 1fr; }
  .medicare-parts { grid-template-columns: 1fr; }
  .contact-grid { grid-template-columns: 1fr; }
  .footer-grid { grid-template-columns: 1fr 1fr; }
  .section-title { font-size: 30px; }
  .header-inner { padding: 0 16px; }
  .phone-header { display: none; }
}
@media (max-width: 500px) {
  .stats-grid { grid-template-columns: 1fr 1fr; gap: 16px; }
  .stat-item h3 { font-size: 32px; }
  .hero-ctas { flex-direction: column; }
  .hero-widget { padding: 24px; }
}

/* ── WIDGET ANCHOR & PULSE ────────────────────────────── */
#widget-anchor { scroll-margin-top: 100px; }

@keyframes widget-pulse {
  0%   { box-shadow: var(--shadow-lg); }
  40%  { box-shadow: 0 8px 48px rgba(16,185,129,0.45); }
  100% { box-shadow: var(--shadow-lg); }
}
.pulse-highlight { animation: widget-pulse 1s ease-in-out; }

/* ── WIDGET PROGRESS BAR ──────────────────────────────── */
#widget-progress-bar {
  position: absolute; top: 0; left: 0; right: 0; height: 5px;
  background: var(--lt-gray);
}
#widget-progress-fill {
  height: 100%; width: 0%; background: var(--green);
  transition: width 0.4s ease;
}

/* ── MOBILE STICKY CTA ────────────────────────────────── */
.mobile-sticky-cta {
  display: none;
  position: fixed; bottom: 0; left: 0; width: 100%; z-index: 1001;
  background: white; border-top: 2px solid var(--green);
  padding: 12px 16px; justify-content: center;
  box-shadow: 0 -4px 20px rgba(0,0,0,0.12);
  transition: transform 0.3s ease;
}
.mobile-sticky-cta button {
  width: 100%; max-width: 400px;
  background: var(--green); color: white;
  border: none; border-radius: 12px;
  font-size: 16px; font-weight: 700;
  padding: 15px 24px; cursor: pointer;
  display: flex; align-items: center; justify-content: center; gap: 10px;
}
.mobile-sticky-cta button:active { filter: brightness(0.9); }


/* ━━━ MOBILE + SENIOR UX OPTIMIZATIONS ━━━━━━━━━━━━━━━ */

/* Prevent iOS from zooming on input focus — inputs must be ≥16px */
input, select, textarea { font-size: 16px !important; }

/* Better touch targets — minimum 44px height */
.btn { min-height: 48px; }
.mobile-nav a {
  font-size: 17px !important;
  padding: 14px 16px !important;
  display: block;
  border-radius: 10px;
  font-weight: 600;
  color: var(--navy);
}
.mobile-nav a:hover { background: var(--lt-blue); }

/* Widget question/subtitle larger on mobile */
@media (max-width: 768px) {
  .widget-q { font-size: 20px !important; line-height: 1.4 !important; }
  .widget-qsub { font-size: 15px !important; }
  .widget-opt-text h4 { font-size: 16px !important; }
  .widget-opt-text p { font-size: 13px !important; }
  .trust-badge { font-size: 13px !important; gap: 6px !important; }
  .trust-badge i { font-size: 16px !important; }
  /* Push page content above sticky bar */
  footer { padding-bottom: 80px !important; }
  /* Floating buttons: lift above sticky bar */
  .wa-float { bottom: 76px !important; }
  .sms-float { bottom: 132px !important; }
  /* Hero text: not too small */
  .hero p { font-size: 17px !important; }
  /* Section padding: not too much */
  section { padding: 40px 16px !important; }
  /* Stat numbers easier to read */
  .stat-number { font-size: 36px !important; }
  /* Contact methods: bigger tap area */
  .contact-method { padding: 20px 16px !important; }
  .contact-method h4 { font-size: 17px !important; }
  .contact-method p { font-size: 14px !important; }
  /* CTA banner */
  .cta-banner { padding: 48px 20px !important; }
  .cta-banner h2 { font-size: 24px !important; line-height: 1.3 !important; }
  .cta-banner p { font-size: 16px !important; }
}

/* iOS safe-area for sticky bar (notch/home bar) */
.mobile-sticky-cta {
  padding-bottom: calc(12px + env(safe-area-inset-bottom, 0px)) !important;
}

/* Focus visible for keyboard/accessibility */
:focus-visible {
  outline: 3px solid var(--green);
  outline-offset: 3px;
}
button:focus-visible, a:focus-visible { outline: 3px solid var(--green); }

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; }
}

/* Better form inputs — senior friendly */
.form-group label { font-size: 15px !important; font-weight: 700 !important; }
.form-group input, .form-group select, .form-group textarea {
  padding: 14px 16px !important;
  font-size: 16px !important;
  border-radius: 10px !important;
  min-height: 52px;
}

/* Widget options: full-width tap area on mobile */
@media (max-width: 768px) {
  .widget-opt { min-height: 70px; }
  .widget-container { padding: 24px 16px !important; }
}

/* Sticky CTA button: larger and bolder */
.mobile-sticky-cta button {
  font-size: 17px !important;
  font-weight: 800 !important;
  min-height: 52px !important;
  letter-spacing: 0.02em;
}

/* Hero button: bolder CTA */
.hero-ctas .btn-primary {
  font-size: 18px !important;
  font-weight: 800 !important;
  padding: 20px 40px !important;
  border-radius: 14px !important;
  letter-spacing: 0.02em;
}
@media (max-width: 768px) {
  .hero-ctas .btn-primary { padding: 18px 24px !important; font-size: 17px !important; width: 100%; }
}

/* Carrier logos: scrollable row on mobile */
@media (max-width: 768px) {
  .carrier-logos {
    flex-wrap: nowrap !important;
    overflow-x: auto;
    padding-bottom: 8px;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }
  .carrier-logos::-webkit-scrollbar { display: none; }
  .carrier-pill { flex-shrink: 0; }
}

/* Smooth scroll offset for fixed header */
html { scroll-padding-top: 90px; }

/* Phone link in footer/contact: tap-friendly */
a[href^="tel"] { white-space: nowrap; }

/* Make nav phone more visible on mobile header */
@media (max-width: 768px) {
  .phone-header { font-size: 16px !important; padding: 8px 0; }
}
</style>
</head>


<body>
<header class="header" id="header">
  <div class="header-inner">
    <a href="javascript:void(0)" class="logo" href="index.html">Medicare <span>Hispano</span></a>
    <nav id="desktop-nav">
      <a href="index.html" data-es="Inicio" data-en="Home">Inicio</a>
      <a href="nosotros.html" data-es="Nosotros" data-en="About">Nosotros</a>
      <a href="medicare101.html" data-es="Medicare 101" data-en="Medicare 101">Medicare 101</a>
      <a href="index.html#widget-anchor" data-es="Encuentra Tu Plan" data-en="Find Your Plan">Encuentra Tu Plan</a>
      <a href="contacto.html" data-es="Contacto" data-en="Contact" class="active">Contacto</a>
      <a href="tel:+18776475260" class="phone-header"><span style="display:flex;flex-direction:column;align-items:center;gap:3px;line-height:1.2"><span><i class="fas fa-phone"></i> (877) MIPLAN-0</span><span style="font-size:11px;font-weight:500;letter-spacing:0.08em;opacity:0.9">1 · 877 · 647 · 5260</span></span></a>
      <button class="lang-toggle" onclick="toggleLang()" id="lang-btn"><img src="https://flagcdn.com/w40/us.png" alt="US"> English</button>
    </nav>
    <button class="mobile-menu-btn" onclick="toggleMobile()"><i class="fas fa-bars"></i></button>
  </div>
</header>

<!-- Mobile nav -->
<div class="mobile-nav" id="mobile-nav">
  <a href="index.html" data-es="Inicio" data-en="Home">Inicio</a>
  <a href="nosotros.html" data-es="Nosotros" data-en="About">Nosotros</a>
  <a href="medicare101.html" data-es="Medicare 101" data-en="Medicare 101">Medicare 101</a>
  <a href="index.html#widget-anchor" data-es="Encuentra Tu Plan" data-en="Find Your Plan">Encuentra Tu Plan</a>
  <a href="contacto.html" data-es="Contacto" data-en="Contact">Contacto</a>
  <a href="tel:+18776475260" style="display:flex;align-items:center;gap:10px;color:var(--green);font-weight:700;font-size:17px;padding:14px 16px;border-radius:10px;text-decoration:none;background:var(--lt-green);margin-top:4px"><i class="fas fa-phone"></i> (877) 647-5260</a>
  <button class="lang-toggle" onclick="toggleLang()" style="margin-top:8px"><img src="https://flagcdn.com/w40/us.png" alt="US"> English</button>
</div>

<!-- SMS floating button -->
<a href="sms:+18776475260&body=Hola%2C%20necesito%20ayuda%20con%20Medicare" class="sms-float" title="Text us">
  <i class="fas fa-comment-dots"></i><span class="float-label">TEXT US</span>
</a>
<!-- WhatsApp floating button -->
<a href="https://wa.me/13105979142?text=Hola%2C%20necesito%20ayuda%20con%20Medicare" class="wa-float" target="_blank" title="WhatsApp">
  <i class="fab fa-whatsapp"></i><span class="float-label">WHATSAPP</span>
</a>

<main id="main-content">
<!-- ═══════════════════════════════════════════════════════ -->
<!-- CONTACTO PAGE -->
<!-- ═══════════════════════════════════════════════════════ -->

  <!-- Hero -->
  <section style="padding-top:140px;padding-bottom:60px;background:linear-gradient(135deg,var(--lt-green) 0%,var(--lt-mint) 100%)">
    <div class="container" style="text-align:center">
      <div class="section-label" data-es="HABLEMOS" data-en="LET'S TALK">HABLEMOS</div>
      <div class="section-title" data-es="Contáctanos" data-en="Contact Us">Contáctanos</div>
      <p class="section-subtitle" data-es="Elige la forma que prefieras. Toda atención es en español y 100% gratuita." data-en="Choose the way you prefer. All service is in Spanish and 100% free.">Elige la forma que prefieras. Toda atención es en español y 100% gratuita.</p>
    </div>
  </section>

  <!-- Contact Grid -->
  <section style="padding:60px 24px;background:white">
    <div class="container">
      <div class="contact-grid">

        <!-- Left: Contact Form -->
        <div class="contact-form">
          <h3 style="color:var(--navy);margin-bottom:8px" data-es="Cuéntanos tu situación" data-en="Tell us your situation">Cuéntanos tu situación</h3>
          <p style="font-size:15px;color:var(--gray);margin-bottom:24px" data-es="Te contactaremos en el horario que prefieras." data-en="We will contact you at your preferred time.">Te contactaremos en el horario que prefieras.</p>
          <form id="contact-form" onsubmit="submitForm(event)">
            <div class="form-group">
              <label data-es="Nombre completo *" data-en="Full name *">Nombre completo *</label>
              <input type="text" name="name" id="cf2-name" required autocomplete="name" inputmode="text" placeholder="Ej: María García" style="font-size:16px;min-height:52px">
            </div>
            <div class="form-group">
              <label data-es="Teléfono *" data-en="Phone *">Teléfono *</label>
              <input type="tel" name="phone" id="cf2-phone" required autocomplete="tel" inputmode="tel" placeholder="(310) 555-1234" style="font-size:16px;min-height:52px">
            </div>
            <div class="form-group">
              <label data-es="Email (opcional)" data-en="Email (optional)">Email (opcional)</label>
              <input type="email" name="email" id="cf2-email" autocomplete="email" inputmode="email" style="font-size:16px;min-height:52px">
            </div>
            <div class="form-group">
              <label data-es="¿Cómo prefieres que te contactemos?" data-en="How do you prefer we contact you?">¿Cómo prefieres que te contactemos?</label>
              <select name="prefer" id="cf2-prefer" style="font-size:16px;min-height:52px">
                <option value="sms" selected data-es="Mensaje de texto (SMS)" data-en="Text message (SMS)">Mensaje de texto (SMS)</option>
                <option value="whatsapp">WhatsApp</option>
                <option value="email">Email</option>
                <option value="call" data-es="Teléfono" data-en="Phone call">Teléfono</option>
              </select>
            </div>
            <div class="form-group">
              <label data-es="¿En qué te podemos ayudar?" data-en="How can we help you?">¿En qué te podemos ayudar?</label>
              <select name="topic" id="cf2-topic" style="font-size:16px;min-height:52px">
                <option value="new" data-es="Me voy a inscribir por primera vez" data-en="First time enrolling in Medicare">Me voy a inscribir por primera vez</option>
                <option value="change" data-es="Quiero cambiar mi plan actual" data-en="I want to change my current plan">Quiero cambiar mi plan actual</option>
                <option value="info" data-es="Solo quiero información" data-en="I just want information">Solo quiero información</option>
                <option value="other" data-es="Otro" data-en="Other">Otro</option>
              </select>
            </div>
            <button type="submit" class="btn btn-primary" style="width:100%;font-size:17px;padding:16px">
              <i class="fas fa-paper-plane"></i> <span data-es="Enviar Mensaje" data-en="Send Message">Enviar Mensaje</span>
            </button>
            <p style="font-size:13px;color:var(--gray);text-align:center;margin-top:12px" data-es="Respondemos en menos de 24 horas (normalmente mucho más rápido)." data-en="We respond within 24 hours (usually much faster).">Respondemos en menos de 24 horas (normalmente mucho más rápido).</p>
          </form>
        </div>

        <!-- Right: Contact Methods + Hours -->
        <div class="contact-methods">
          <a href="https://wa.me/13105979142?text=Hola%2C%20necesito%20ayuda%20con%20Medicare" target="_blank" class="contact-method">
            <div class="contact-method-icon" style="background:#25D366"><i class="fab fa-whatsapp"></i></div>
            <div>
              <h4>WhatsApp</h4>
              <p data-es="Escríbenos un mensaje ahora mismo." data-en="Send us a message right now.">Escríbenos un mensaje ahora mismo.</p>
            </div>
          </a>
          <a href="sms:+18776475260&body=Hola%2C%20necesito%20ayuda%20con%20Medicare" class="contact-method">
            <div class="contact-method-icon" style="background:var(--teal)"><i class="fas fa-comment-dots"></i></div>
            <div>
              <h4 data-es="Mensaje de Texto (SMS)" data-en="Text Message (SMS)">Mensaje de Texto (SMS)</h4>
              <p>(877) 647-5260</p>
            </div>
          </a>
          <a href="tel:+18776475260" class="contact-method">
            <div class="contact-method-icon" style="background:var(--navy)"><i class="fas fa-phone"></i></div>
            <div>
              <h4>(877) MIPLAN-0</h4>
              <p style="font-size:13px;color:var(--gray)">1 · 877 · 647 · 5260</p>
            </div>
          </a>
          <a href="https://calendar.app.google/6D4obxzxERQXBpaf7" target="_blank" class="contact-method">
            <div class="contact-method-icon" style="background:var(--green)"><i class="fas fa-calendar-check"></i></div>
            <div>
              <h4 data-es="Agenda una Cita" data-en="Book an Appointment">Agenda una Cita</h4>
              <p data-es="15 minutos, gratuita. Sin obligación." data-en="15 minutes, free. No obligation.">15 minutos, gratuita. Sin obligación.</p>
            </div>
          </a>
          <a href="mailto:alejamedicare@gmail.com" class="contact-method">
            <div class="contact-method-icon" style="background:var(--blue)"><i class="fas fa-envelope"></i></div>
            <div>
              <h4>alejamedicare@gmail.com</h4>
              <p data-es="Respondemos en 24 horas." data-en="We respond within 24 hours.">Respondemos en 24 horas.</p>
            </div>
          </a>

          <!-- Hours -->
          <div style="background:var(--lt-mint);border-radius:var(--radius);padding:24px;margin-top:8px">
            <p style="font-size:14px;color:var(--teal);font-weight:700;margin-bottom:12px;display:flex;align-items:center;gap:8px"><i class="fas fa-clock"></i> <span data-es="Horario de Atención (CT)" data-en="Service Hours (CT)">Horario de Atención (CT)</span></p>
            <div style="display:flex;flex-direction:column;gap:4px">
              <p style="font-size:14px;color:var(--dark);margin:0" data-es="Lunes a Viernes: 9am – 6pm CT" data-en="Monday to Friday: 9am – 6pm CT">Lun a Vie: 9am – 6pm CT</p>
              <p style="font-size:14px;color:var(--dark);margin:0" data-es="Sábado: 8am – 12pm PT" data-en="Saturday: 8am – 12pm PT">Sábado: 8am – 12pm PT</p>
            </div>
            <p style="font-size:13px;color:var(--teal);margin-top:10px;margin-bottom:0" data-es="También disponibles por WhatsApp fuera de horario." data-en="Also available via WhatsApp outside business hours.">También disponibles por WhatsApp fuera de horario.</p>
          </div>
        </div>

      </div>
    </div>
  </section>

  <!-- Seminar CTA Banner -->
  <section class="cta-banner" style="text-align:center;padding:50px 24px">
    <div class="container">
      <div class="section-title" style="color:white;margin-bottom:8px" data-es="¿Prefieres una consulta en persona?" data-en="Prefer an in-person consultation?">¿Prefieres una consulta en persona?</div>
      <p style="color:rgba(255,255,255,0.9);font-size:17px;margin-bottom:24px" data-es="Ofrecemos consultas en persona en el sur de California y visitas a domicilio para adultos mayores." data-en="We offer in-person consultations in Southern California and home visits for seniors.">Ofrecemos consultas en persona en el sur de California y visitas a domicilio para adultos mayores.</p>
      <a href="https://calendar.app.google/6D4obxzxERQXBpaf7" target="_blank" class="btn" style="background:white;color:var(--navy);font-weight:700;font-size:16px;padding:16px 32px;border-radius:50px;text-decoration:none;display:inline-flex;align-items:center;gap:8px">
        <i class="fas fa-calendar-check"></i> <span data-es="Agenda Tu Cita Gratis" data-en="Book Your Free Appointment">Agenda Tu Cita Gratis</span>
      </a>
    </div>
  </section>

</main>


<footer>
  <div class="footer-grid">
    <div>
      <div style="font-family:'Playfair Display',serif;font-size:22px;color:white;margin-bottom:12px">Susana Marcos <span style="color:var(--mint)">LLC</span></div>
      <p data-es="Agentes de Medicare bilingües con licencia en California, Illinois, Texas, Oklahoma, Florida e Iowa. Nuestro servicio es siempre 100% gratuito." data-en="Bilingual Medicare agents licensed in California, Illinois, Texas, Oklahoma, Florida, and Iowa. Our service is always 100% free.">Agentes de Medicare bilingües con licencia en California, Illinois, Texas, Oklahoma, Florida e Iowa. Nuestro servicio es siempre 100% gratuito.</p>
    </div>
    <div>
      <h4 data-es="Páginas" data-en="Pages">Páginas</h4>
      <a href="index.html" data-es="Inicio" data-en="Home">Inicio</a>
      <a href="nosotros.html" data-es="Nosotros" data-en="About">Nosotros</a>
      <a href="medicare101.html">Medicare 101</a>
      <a href="index.html#widget-anchor" data-es="Encuentra Tu Plan" data-en="Find Your Plan">Encuentra Tu Plan</a>
      <a href="contacto.html" data-es="Contacto" data-en="Contact">Contacto</a>
    </div>
    <div>
      <h4 data-es="Contacto" data-en="Contact">Contacto</h4>
      <a href="tel:+18776475260">(877) MIPLAN-0</a><br><small style="color:rgba(255,255,255,0.6);font-size:12px;letter-spacing:0.08em;font-weight:500">1 · 877 · 647 · 5260</small>
      <a href="mailto:alejamedicare@gmail.com">alejamedicare@gmail.com</a>
      <a href="https://wa.me/13105979142" target="_blank">WhatsApp</a>
    </div>
    <div>
      <h4 data-es="Horario" data-en="Hours">Horario</h4>
      <p data-es="Lunes a Viernes: 7am–4pm PT<br>Sábado: 8am–12pm PT<br>Domingo: Solo con cita" data-en="Monday to Friday: 7am–4pm PT<br>Saturday: 8am–12pm PT<br>Sunday: By appointment only">Lunes a Viernes: 7am–4pm PT<br>Sábado: 8am–12pm PT<br>Domingo: Solo con cita</p>
    </div>
  </div>
  <div style="text-align:center;padding:20px 24px 0;border-top:1px solid rgba(255,255,255,0.1)">
    <p style="font-size:15px;color:var(--mint);font-weight:600;margin-bottom:4px" data-es="Alejandra Brizuela Marcos" data-en="Alejandra Brizuela Marcos">Alejandra Brizuela Marcos</p>
    <p style="font-size:13px;color:rgba(255,255,255,0.7);margin-bottom:4px" data-es="Agente Licenciada de Medicare — Susana Marcos LLC" data-en="Licensed Medicare Insurance Agent | Susana Marcos LLC">Agente Licenciada de Medicare — Susana Marcos LLC</p>
    <p style="font-size:14px;color:white;font-weight:600;margin-bottom:4px">(877) MIPLAN-0 | alejamedicare@gmail.com</p>
    <p style="font-size:13px;color:rgba(255,255,255,0.7);font-style:italic;margin-bottom:4px" data-es="Agente Licenciada en CA | Hablo Español" data-en="CA Licensed Agent | Hablo Español">Agente Licenciada en CA | Hablo Español</p>
  </div>
  <div class="footer-bottom" data-es="Not connected with or endorsed by the U.S. government or the federal Medicare program. There is no cost or obligation to you for my services." data-en="Not connected with or endorsed by the U.S. government or the federal Medicare program. There is no cost or obligation to you for my services.">Not connected with or endorsed by the U.S. government or the federal Medicare program. There is no cost or obligation to you for my services.</div>
</footer>

<!-- ── MOBILE STICKY CTA ─────────────────────────────── -->
<div class="mobile-sticky-cta" id="mobile-sticky-cta">
  <button onclick="smoothScrollToWidget()">
    <i class="fas fa-search"></i>
    <span data-es="¡Empiece Su Comparación Gratis!" data-en="Start Your Free Comparison!">¡Empiece Su Comparación Gratis!</span>
  </button>
</div>

<script>
// ═══ STATE ════════════════════════════════════════════════
let currentLang = 'es';
let currentPage = 'contact';
let widgetState = { situation: null, zip: null };

// ═══ PAGE NAVIGATION ═════════════════════════════════════
// Navigation handled by href links
// ═══ LANGUAGE TOGGLE ═════════════════════════════════════
function toggleLang() {
  currentLang = currentLang === 'es' ? 'en' : 'es';
  updateLang();
}

function updateLang() {
  const opposite = currentLang === 'es' ? 'en' : 'es';
  document.querySelectorAll('.lang-toggle').forEach(b => {
    if (currentLang === 'es') {
      b.innerHTML = '<img src="https://flagcdn.com/w40/us.png" alt="US" style="width:20px;height:14px;border-radius:2px;object-fit:cover"> English';
    } else {
      b.innerHTML = '<img src="https://flagcdn.com/w40/mx.png" alt="MX" style="width:20px;height:14px;border-radius:2px;object-fit:cover"> Español';
    }
  });
  document.documentElement.lang = currentLang;

  document.querySelectorAll('[data-es][data-en]').forEach(el => {
    const text = el.dataset[currentLang];
    if (text) {
      if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
        el.placeholder = text;
      } else {
        el.innerHTML = text;
      }
    }
  });
}

// ═══ MOBILE MENU ═════════════════════════════════════════
function toggleMobile() {
  document.getElementById('mobile-nav').classList.toggle('open');
}
function closeMobile() {
  document.getElementById('mobile-nav').classList.remove('open');
}

// ═══ HEADER SCROLL ═══════════════════════════════════════
window.addEventListener('scroll', () => {
  document.getElementById('header').classList.toggle('scrolled', window.scrollY > 10);
});

// ═══════════════════════════════════════════════════════════
// WIDGET SYSTEM — 4 Full Flows (Enhanced)
// ═══════════════════════════════════════════════════════════
let wData = {};

const CHRONIC_CONDITIONS = [
  { group: 'Cardiovascular', es: 'Cardiovascular', items: [
    { v: 'heart_failure', es: 'Insuficiencia cardíaca crónica', en: 'Chronic Heart Failure' },
    { v: 'arrhythmia',   es: 'Arritmia cardíaca', en: 'Cardiac Arrhythmia' },
    { v: 'cad',          es: 'Enfermedad coronaria', en: 'Coronary Artery Disease' },
    { v: 'pvd',          es: 'Enfermedad vascular periférica', en: 'Peripheral Vascular Disease' },
  ]},
  { group: 'Diabetes', es: 'Diabetes', items: [
    { v: 'diabetes1', es: 'Diabetes tipo 1', en: 'Diabetes Type 1' },
    { v: 'diabetes2', es: 'Diabetes tipo 2', en: 'Diabetes Type 2' },
  ]},
  { group: 'Respiratory', es: 'Pulmón / Respiratorio', items: [
    { v: 'asthma',   es: 'Asma', en: 'Asthma' },
    { v: 'copd',     es: 'EPOC / Bronquitis crónica', en: 'COPD / Chronic Bronchitis' },
    { v: 'emphysema',es: 'Enfisema', en: 'Emphysema' },
    { v: 'pul_hyp',  es: 'Hipertensión pulmonar', en: 'Pulmonary Hypertension' },
  ]},
  { group: 'Neurological', es: 'Neurológico', items: [
    { v: 'dementia',  es: 'Demencia / Alzheimer', en: 'Dementia / Alzheimer\'s' },
    { v: 'parkinsons',es: 'Parkinson', en: 'Parkinson\'s Disease' },
    { v: 'ms',        es: 'Esclerosis múltiple', en: 'Multiple Sclerosis' },
    { v: 'stroke',    es: 'Secuelas de derrame cerebral', en: 'Stroke-Related Deficits' },
    { v: 'epilepsy',  es: 'Epilepsia', en: 'Epilepsy' },
    { v: 'als',       es: 'ELA (ALS)', en: 'ALS' },
  ]},
  { group: 'Cancer', es: 'Cáncer', items: [
    { v: 'cancer', es: 'Cáncer (activo)', en: 'Cancer (active)' },
  ]},
  { group: 'Kidney / Liver', es: 'Riñón / Hígado', items: [
    { v: 'esrd',      es: 'Enfermedad renal terminal (diálisis)', en: 'End-Stage Renal Disease (dialysis)' },
    { v: 'esld',      es: 'Enfermedad hepática terminal', en: 'End-Stage Liver Disease' },
  ]},
  { group: 'Mental Health', es: 'Salud mental', items: [
    { v: 'depression',es: 'Depresión mayor', en: 'Major Depression' },
    { v: 'bipolar',   es: 'Trastorno bipolar', en: 'Bipolar Disorder' },
    { v: 'schizo',    es: 'Esquizofrenia / Trastorno esquizoafectivo', en: 'Schizophrenia / Schizoaffective' },
  ]},
  { group: 'Autoimmune', es: 'Autoinmune', items: [
    { v: 'ra',    es: 'Artritis reumatoide', en: 'Rheumatoid Arthritis' },
    { v: 'lupus', es: 'Lupus', en: 'Lupus (SLE)' },
  ]},
  { group: 'Blood / Other', es: 'Sangre / Otro', items: [
    { v: 'sickle',  es: 'Anemia de células falciformes', en: 'Sickle-Cell Disease' },
    { v: 'hiv',     es: 'VIH/SIDA', en: 'HIV/AIDS' },
    { v: 'alcohol_drug', es: 'Dependencia crónica a alcohol/drogas', en: 'Chronic Alcohol/Drug Dependence' },
  ]},
];

function showWidgetStep(id) {
  document.querySelectorAll('.widget-step').forEach(s => s.classList.remove('active'));
  const el = document.getElementById(id);
  if (el) { el.classList.add('active'); window.scrollTo({top:0,behavior:'smooth'}); }
}
function wBack(id) { showWidgetStep(id); }

function startFlow(type) { updateWidgetProgress(10);
  const es = currentLang === 'es';
  if (type === 'first-time') { wData = { flow: type }; renderFT_Step1(es); }
  else if (type === 'moving') { wData = { flow: type }; renderMV_Step1(es); }
  else if (type === 'better') { wData = { flow: 'better' }; renderBT_Step1(es); }
  else if (type === 'parent') { wData = { flow: 'better', forWhom: 'family' }; bt_who('family'); showWidgetStep('flow-better'); }
}

// ── SHARED HELPERS ────────────────────────────────────────
function shell(containerId, backId, iconCls, bgColor, q_es, q_en, sub_es, sub_en, body) {
  const es = currentLang === 'es';
  document.getElementById(containerId).innerHTML = `
    <button class="widget-back" onclick="wBack('${backId}')"><i class="fas fa-arrow-left"></i> ${es?'Atrás':'Back'}</button>
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
      <div style="width:40px;height:40px;border-radius:10px;background:${bgColor};display:flex;align-items:center;justify-content:center;color:white;font-size:18px;flex-shrink:0"><i class="${iconCls}"></i></div>
      <div class="widget-q" style="margin:0">${es?q_es:q_en}</div>
    </div>
    <div class="widget-qsub">${es?sub_es:sub_en}</div>
    ${body}
  `;
}

function opt(es_lbl, en_lbl, onclick_fn, note_es='', note_en='') {
  const es = currentLang === 'es';
  const note = es ? note_es : note_en;
  return `<button onclick="${onclick_fn}" style="width:100%;text-align:left;padding:14px 18px;margin-bottom:10px;border:2px solid var(--lt-blue);border-radius:10px;background:white;font-size:15px;font-family:inherit;cursor:pointer;color:var(--dark);transition:all 0.15s" onmouseover="this.style.borderColor='var(--blue)';this.style.background='var(--lt-blue)'" onmouseout="this.style.borderColor='var(--lt-blue)';this.style.background='white'">
    ${es?es_lbl:en_lbl}${note?`<br><span style="font-size:12px;color:var(--gray)">${note}</span>`:''}
  </button>`;
}

function inp(id, lbl_es, lbl_en, type='text', ph_es='', ph_en='', req=false) {
  const es = currentLang === 'es';
  // smart inputmode + autocomplete hints
  const isZip   = id.includes('zip');
  const isPhone = id.includes('phone') || id.includes('tel') || id.includes('cel');
  const isName  = id.includes('name') || id.includes('nombre');
  const isEmail = id.includes('email') || id.includes('correo');
  const imode   = isZip ? 'numeric' : isPhone ? 'tel' : isEmail ? 'email' : 'text';
  const acomp   = isName ? 'name' : isPhone ? 'tel' : isEmail ? 'email' : isZip ? 'postal-code' : 'off';
  return `<div style="margin-bottom:14px">
    <label style="display:block;font-size:15px;font-weight:700;color:var(--navy);margin-bottom:8px">${es?lbl_es:lbl_en}${req?' <span style="color:#DC2626">*</span>':''}</label>
    <input id="${id}" type="${type}" inputmode="${imode}" autocomplete="${acomp}" placeholder="${es?ph_es:ph_en}"
      style="width:100%;padding:14px 16px;border:2px solid var(--lt-gray);border-radius:10px;font-size:16px;font-family:inherit;outline:none;min-height:52px"
      onfocus="this.style.borderColor='var(--blue)';this.style.boxShadow='0 0 0 3px rgba(29,114,184,0.15)'"
      onblur="this.style.borderColor='var(--lt-gray)';this.style.boxShadow='none'">
  </div>`;
}

function sel(id, lbl_es, lbl_en, optionsHtml) {
  const es = currentLang === 'es';
  return `<div style="margin-bottom:14px">
    <label style="display:block;font-size:15px;font-weight:700;color:var(--navy);margin-bottom:8px">${es?lbl_es:lbl_en}</label>
    <select id="${id}"
      style="width:100%;padding:14px 16px;border:2px solid var(--lt-gray);border-radius:10px;font-size:16px;font-family:inherit;color:var(--dark);outline:none;min-height:52px;-webkit-appearance:auto"
      onfocus="this.style.borderColor='var(--blue)';this.style.boxShadow='0 0 0 3px rgba(29,114,184,0.15)'"
      onblur="this.style.borderColor='var(--lt-gray)';this.style.boxShadow='none'">
      ${optionsHtml}
    </select>
  </div>`;
}

function nextBtn(lbl_es, lbl_en, fn) {
  const es = currentLang === 'es';
  return `<button onclick="${fn}" class="btn btn-primary" style="width:100%;justify-content:center;margin-top:12px;font-size:17px;padding:17px;min-height:54px;font-weight:700;letter-spacing:0.02em">${es?lbl_es:lbl_en} <i class="fas fa-arrow-right"></i></button>`;
}

function getVal(id) { const el=document.getElementById(id); return el?el.value.trim():''; }
function getChecked(name) {
  return Array.from(document.querySelectorAll(`input[name="${name}"]:checked`)).map(c=>c.value);
}

// ── ZIP → STATE AUTO-GUESS ────────────────────────────────
function zipToState(zip) {
  if (!zip || zip.length < 3) return '';
  const p = parseInt(zip.substring(0, 3), 10);
  if (isNaN(p)) return '';
  const map = [
    [0,6,'PR'],[6,10,'NH'],[10,28,'MA'],[28,30,'RI'],[30,56,'NY'],[56,63,'NJ'],[66,100,'PA'],
    [100,150,'PA'],[150,197,'PA'],[197,200,'DE'],[200,206,'DC'],[206,213,'MD'],[213,247,'VA'],
    [247,269,'WV'],[270,290,'NC'],[290,300,'SC'],[300,320,'GA'],[320,350,'FL'],[350,370,'AL'],
    [370,386,'TN'],[386,398,'MS'],[400,430,'KY'],[430,460,'OH'],[460,480,'IN'],[480,500,'MI'],
    [500,530,'IA'],[530,550,'WI'],[550,568,'MN'],[570,578,'SD'],[580,589,'ND'],[590,600,'MT'],
    [600,633,'IL'],[633,659,'MO'],[660,680,'KS'],[680,694,'NE'],[700,716,'LA'],[716,730,'AR'],
    [730,750,'OK'],[750,800,'TX'],[800,817,'CO'],[820,832,'WY'],[832,839,'ID'],[840,848,'UT'],
    [850,866,'AZ'],[870,886,'NM'],[889,899,'NV'],[900,962,'CA'],[967,969,'HI'],[970,980,'OR'],
    [980,995,'WA'],[995,1000,'AK']
  ];
  for (const [lo, hi, st] of map) if (p >= lo && p < hi) return st;
  return '';
}

// ── CARRIER DROPDOWN ──────────────────────────────────────
function carrierSel(id) {
  const es = currentLang === 'es';
  const carriers = [
    'Kaiser Permanente','UnitedHealthcare (AARP)','Aetna / CVS Health',
    'Humana','Anthem Blue Cross','Blue Shield of California','Molina Healthcare'
  ];
  const opts = carriers.map(c => `<option value="${c}">${c}</option>`).join('');
  return `<div style="margin-bottom:14px">
    <label style="display:block;font-size:14px;font-weight:600;color:var(--navy);margin-bottom:6px">
      ${es?'¿Con qué aseguradora tienes tu plan?':'What is your current insurance carrier?'}
    </label>
    <select id="${id}" onchange="toggleOtherCarrier('${id}')" style="width:100%;padding:13px 16px;border:2px solid var(--lt-gray);border-radius:10px;font-size:15px;font-family:inherit;color:var(--dark);outline:none">
      <option value="">${es?'Selecciona tu aseguradora':'Select your carrier'}</option>
      ${opts}
      <option value="other">${es?'Otra aseguradora':'Other carrier'}</option>
    </select>
    <input id="${id}-other" type="text" placeholder="${es?'Escribe el nombre de la aseguradora':'Type the carrier name'}"
      style="display:none;width:100%;margin-top:8px;padding:13px 16px;border:2px solid var(--lt-gray);border-radius:10px;font-size:15px;font-family:inherit;outline:none">
  </div>`;
}
function toggleOtherCarrier(id) {
  const sel = document.getElementById(id);
  const other = document.getElementById(id + '-other');
  if (other) other.style.display = (sel && sel.value === 'other') ? 'block' : 'none';
}

// ── CHRONIC CONDITIONS PANEL ──────────────────────────────
function chronicPanel() {
  const es = currentLang === 'es';
  let html = `<div style="margin-bottom:20px">
    <label style="display:block;font-size:14px;font-weight:600;color:var(--navy);margin-bottom:10px">
      ${es?'¿Tu familiar o tú tiene alguna de estas condiciones crónicas? (Selecciona todas las que apliquen)':'Do you (or your family member) have any of these chronic conditions? (Select all that apply)'}
    </label>
    <div style="border:2px solid var(--lt-blue);border-radius:10px;padding:16px;background:white;max-height:280px;overflow-y:auto">`;
  CHRONIC_CONDITIONS.forEach(group => {
    html += `<div style="margin-bottom:12px"><div style="font-size:12px;font-weight:700;color:var(--teal);text-transform:uppercase;letter-spacing:1px;margin-bottom:6px">${es?group.es:group.group}</div>`;
    group.items.forEach(item => {
      html += `<label style="display:flex;align-items:center;gap:8px;font-size:14px;color:var(--dark);margin-bottom:4px;cursor:pointer">
        <input type="checkbox" name="chronic" value="${item.v}" style="width:16px;height:16px;accent-color:var(--navy)">
        ${es?item.es:item.en}
      </label>`;
    });
    html += `</div>`;
  });
  html += `</div>
    <label style="display:flex;align-items:center;gap:8px;font-size:14px;color:var(--gray);margin-top:8px;cursor:pointer">
      <input type="checkbox" name="chronic" value="none" id="chronic-none" style="width:16px;height:16px;accent-color:var(--green)">
      <em>${es?'Ninguna de las anteriores':'None of the above'}</em>
    </label>
  </div>`;
  return html;
}

function partABQuestion() {
  const es = currentLang === 'es';
  return sel('partab',
    '¿Ya tienes Medicare Parte A y Parte B?',
    'Do you already have Medicare Part A and Part B?',
    `<option value="both">${es?'Sí, tengo ambas (Parte A y B)':'Yes, I have both (Part A and B)'}</option>
     <option value="a_only">${es?'Solo Parte A':'Part A only'}</option>
     <option value="neither">${es?'No, todavía no tengo ninguna':'No, I don\'t have either yet'}</option>
     <option value="unsure">${es?'No estoy seguro/a':'Not sure'}</option>`
  );
}

// ══════════════════════════════════════════════════
// FLOW 1 — TURNING 65 / FIRST TIME
// ══════════════════════════════════════════════════
function renderFT_Step1(es) {
  const months_es = ['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'];
  const months_en = ['January','February','March','April','May','June','July','August','September','October','November','December'];
  const months = es ? months_es : months_en;
  const currentYear = new Date().getFullYear();
  let monthOpts = `<option value="">${es?'Mes':'Month'}</option>` + months.map((m,i)=>`<option value="${i+1}">${m}</option>`).join('');
  let yearOpts  = `<option value="">${es?'Año':'Year'}</option>`;
  for(let y=currentYear; y<=currentYear+2; y++) yearOpts += `<option value="${y}">${y}</option>`;

  document.getElementById('flow-first-time').innerHTML = `
    <button class="widget-back" onclick="wBack('w-step-0')"><i class="fas fa-arrow-left"></i> ${es?'Atrás':'Back'}</button>
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
      <div style="width:40px;height:40px;border-radius:10px;background:var(--navy);display:flex;align-items:center;justify-content:center;color:white;font-size:18px;flex-shrink:0"><i class="fas fa-birthday-cake"></i></div>
      <div class="widget-q" style="margin:0">${es?'¿Cuándo cumples 65?':'When do you turn 65?'}</div>
    </div>
    <div class="widget-qsub">${es?'Esto determina exactamente cuánto tiempo tienes para inscribirte sin penalidades permanentes.':'This determines exactly how much time you have to enroll without permanent penalties.'}</div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:14px">
      <div>
        <label style="display:block;font-size:14px;font-weight:600;color:var(--navy);margin-bottom:6px">${es?'Mes*':'Month*'}</label>
        <select id="ft-month" style="width:100%;padding:13px 12px;border:2px solid var(--lt-gray);border-radius:10px;font-size:15px;font-family:inherit">${monthOpts}</select>
      </div>
      <div>
        <label style="display:block;font-size:14px;font-weight:600;color:var(--navy);margin-bottom:6px">${es?'Año*':'Year*'}</label>
        <select id="ft-year" style="width:100%;padding:13px 12px;border:2px solid var(--lt-gray);border-radius:10px;font-size:15px;font-family:inherit">${yearOpts}</select>
      </div>
    </div>
    <div style="display:grid;grid-template-columns:2fr 1fr;gap:12px;align-items:start">${inp('ft-zip', 'Código postal*', 'Zip code*', 'text', 'Ej: 90028', 'E.g. 90028', true)}${inp('ft-state', 'Estado', 'State', 'text', 'CA', 'CA', false)}</div>
    ${nextBtn('Continuar', 'Continue', 'ft_step2()')}
  `;
  showWidgetStep('flow-first-time');
  setTimeout(() => {
    const zipEl = document.getElementById('ft-zip');
    const stEl  = document.getElementById('ft-state');
    if (zipEl && stEl) {
      zipEl.addEventListener('input', function() {
        const st = zipToState(this.value);
        if (st && !stEl._touched) { stEl.value = st; stEl.style.color='var(--teal)'; }
      });
      stEl.addEventListener('input', function() { this._touched = true; this.style.color='var(--dark)'; });
    }
  }, 0);
}

function ft_step2() { updateWidgetProgress(30);
  const month = getVal('ft-month'), year = getVal('ft-year'), zip = getVal('ft-zip'), state = getVal('ft-state');
  if (!month || !year || !zip) {
    if(!month) document.getElementById('ft-month').style.borderColor='#DC2626';
    if(!year) document.getElementById('ft-year').style.borderColor='#DC2626';
    if(!zip) document.getElementById('ft-zip').style.borderColor='#DC2626';
    return;
  }
  wData.birthday = { month, year }; wData.zip = zip; wData.state = state;
  const es = currentLang === 'es';
  shell('flow-first-time','flow-first-time','fas fa-briefcase','var(--navy)',
    '¿Sigues trabajando actualmente?', 'Are you currently still working?',
    'Si tienes seguro de empleador activo, hay reglas importantes sobre cuándo inscribirse.', 'If you have active employer coverage, there are important rules about when to enroll.',
    opt('Sí, trabajo y tengo seguro de mi empleador','Yes, I work and have employer insurance',"ft_work('yes-employer')",
        'Puede haber una excepción para retrasar Medicare','You may qualify to delay Medicare') +
    opt('Sí trabajo, pero SIN seguro de empleador','Yes I work, but with NO employer insurance',"ft_work('yes-noinsurance')") +
    opt('No, ya estoy jubilado/a','No, I am retired',"ft_work('retired')") +
    opt('Tengo seguro del trabajo de mi esposo/a','I\'m on my spouse\'s employer plan',"ft_work('spouse-plan')")
  );
}

function ft_work(w) {
  wData.workStatus = w;
  const es = currentLang === 'es';
  shell('flow-first-time','flow-first-time','fas fa-id-card','var(--navy)',
    '¿Ya tienes Medicare Parte A y Parte B?', 'Do you already have Medicare Part A and Part B?',
    'Esto cambia mucho el proceso. Si ya los tienes, nos enfocamos en elegir el plan correcto.', 'This changes the process significantly. If you already have them, we focus on choosing the right plan.',
    partABQuestion() +
    nextBtn('Continuar','Continue','ft_step3()')
  );
}

function ft_step3() { updateWidgetProgress(55);
  wData.partAB = getVal('partab');
  const es = currentLang === 'es';
  shell('flow-first-time','flow-first-time','fas fa-pills','var(--navy)',
    '¿Tomás medicamentos recetados regularmente?', 'Do you take prescription medications regularly?',
    'El tipo y cantidad de medicinas afecta cuál plan de Parte D o Medicare Advantage es el mejor para ti.', 'The type and quantity of medications affects which Part D or Medicare Advantage plan is best for you.',
    opt('No tomo ningún medicamento recetado','I take no prescription medications',"ft_meds('none')") +
    opt('Tomo 1–3 medicamentos','I take 1–3 medications',"ft_meds('few')") +
    opt('Tomo 4 o más medicamentos','I take 4 or more medications',"ft_meds('many')") +
    opt('Tengo medicamentos costosos o de marca','I have expensive or brand-name medications',"ft_meds('expensive')",'Más de $100/mes','More than $100/month')
  );
}

function ft_meds(m) {
  wData.meds = m;
  const es = currentLang === 'es';
  document.getElementById('flow-first-time').innerHTML = `
    <button class="widget-back" onclick="wBack('flow-first-time')"><i class="fas fa-arrow-left"></i> ${es?'Atrás':'Back'}</button>
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
      <div style="width:40px;height:40px;border-radius:10px;background:var(--teal);display:flex;align-items:center;justify-content:center;color:white;font-size:18px;flex-shrink:0"><i class="fas fa-heartbeat"></i></div>
      <div class="widget-q" style="margin:0">${es?'Condiciones de salud':'Health Conditions'}</div>
    </div>
    <div class="widget-qsub">${es?'Si tienes condiciones crónicas, puede haber planes especiales (C-SNP) diseñados exactamente para tu situación.':'If you have chronic conditions, there may be special plans (C-SNPs) designed exactly for your situation.'}</div>
    ${chronicPanel()}
    ${nextBtn('Continuar','Continue','ft_step4()')}
  `;
}

function ft_step4() { updateWidgetProgress(75);
  wData.chronic = getChecked('chronic');
  renderUrgencyStep('flow-first-time', 'first-time');
}

// ══════════════════════════════════════════════════
// FLOW 2 — MOVING
// ══════════════════════════════════════════════════
function renderMV_Step1(es) {
  document.getElementById('flow-moving').innerHTML = `
    <button class="widget-back" onclick="wBack('w-step-0')"><i class="fas fa-arrow-left"></i> ${es?'Atrás':'Back'}</button>
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
      <div style="width:40px;height:40px;border-radius:10px;background:var(--blue);display:flex;align-items:center;justify-content:center;color:white;font-size:18px;flex-shrink:0"><i class="fas fa-truck-moving"></i></div>
      <div class="widget-q" style="margin:0">${es?'Cuéntame de tu mudanza':'Tell me about your move'}</div>
    </div>
    <div class="widget-qsub">${es?'Al mudarte calificas para un Período Especial de Inscripción (SEP). El tiempo importa.':'When you move, you qualify for a Special Enrollment Period (SEP). Timing matters.'}</div>
    <div style="display:grid;grid-template-columns:2fr 1fr;gap:12px;align-items:start">${inp('mv-zip-from', 'ZIP de origen*', 'Origin zip*', 'text', 'Ej: 60601', 'E.g. 60601', true)}${inp('mv-state-from', 'Estado', 'State', 'text', 'IL', 'IL', false)}</div>
    <div style="display:grid;grid-template-columns:2fr 1fr;gap:12px;align-items:start">${inp('mv-zip-to', 'ZIP de destino*', 'Destination zip*', 'text', 'Ej: 90028', 'E.g. 90028', true)}${inp('mv-state-to', 'Estado nuevo', 'New state', 'text', 'CA', 'CA', false)}</div>
    ${sel('mv-when', '¿Cuándo es la mudanza?', 'When is the move?',
      `<option value="moved">${es?'Ya me mudé (últimos 60 días)':'I already moved (within last 60 days)'}</option>
       <option value="30d">${es?'Me mudo en los próximos 30 días':'Moving within the next 30 days'}</option>
       <option value="90d">${es?'Me mudo en 1–3 meses':'Moving in 1–3 months'}</option>
       <option value="planning">${es?'Solo estoy planeando':'Just planning ahead'}</option>`
    )}
    ${nextBtn('Continuar','Continue','mv_step2()')}
  `;
  showWidgetStep('flow-moving');
  setTimeout(() => {
    [['mv-zip-from','mv-state-from'],['mv-zip-to','mv-state-to']].forEach(([zId, sId]) => {
      const zipEl = document.getElementById(zId);
      const stEl  = document.getElementById(sId);
      if (zipEl && stEl) {
        zipEl.addEventListener('input', function() {
          const st = zipToState(this.value);
          if (st && !stEl._touched) { stEl.value = st; stEl.style.color='var(--teal)'; }
        });
        stEl.addEventListener('input', function() { this._touched = true; this.style.color='var(--dark)'; });
      }
    });
  }, 0);
}

function mv_step2() { updateWidgetProgress(40);
  const zf=getVal('mv-zip-from'), zt=getVal('mv-zip-to');
  if(!zf||!zt){if(!zf)document.getElementById('mv-zip-from').style.borderColor='#DC2626';if(!zt)document.getElementById('mv-zip-to').style.borderColor='#DC2626';return;}
  wData.zipFrom=zf; wData.stateFrom=getVal('mv-state-from');
  wData.zipTo=zt; wData.stateTo=getVal('mv-state-to'); wData.moveWhen=getVal('mv-when');
  const es = currentLang === 'es';
  shell('flow-moving','flow-moving','fas fa-file-medical','var(--blue)',
    '¿Qué tipo de plan de Medicare tienes ahora?', 'What type of Medicare plan do you have now?',
    'Los planes de Medicare Advantage son locales. Al cruzar de condado o estado, tu plan puede quedar inválido.', 'Medicare Advantage plans are local. Crossing county or state lines may invalidate your current plan.',
    opt('Medicare Advantage (Parte C) — plan todo-en-uno','Medicare Advantage (Part C) — all-in-one plan',"mv_plan('advantage')") +
    opt('Medicare Original + Suplemento (Medigap)','Original Medicare + Supplement (Medigap)',"mv_plan('medigap')") +
    opt('Medicare Original solamente (sin suplemento)','Original Medicare only (no supplement)',"mv_plan('original')") +
    opt('No sé / No estoy seguro/a',"I don't know / Not sure","mv_plan('unknown')")
  );
}

function mv_plan(p) {
  wData.plantype = p;
  const es = currentLang === 'es';
  shell('flow-moving','flow-moving','fas fa-id-card','var(--blue)',
    '¿Ya tienes Medicare Parte A y Parte B?', 'Do you already have Medicare Part A and Part B?',
    'Necesitamos saber esto para asegurarnos de que haya continuidad de cobertura al mudarte.', 'We need to know this to ensure coverage continuity during your move.',
    partABQuestion() +
    nextBtn('Continuar','Continue','mv_step3()')
  );
}

function mv_step3() { updateWidgetProgress(70);
  wData.partAB = getVal('partab');
  const es = currentLang === 'es';
  document.getElementById('flow-moving').innerHTML = `
    <button class="widget-back" onclick="wBack('flow-moving')"><i class="fas fa-arrow-left"></i> ${es?'Atrás':'Back'}</button>
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
      <div style="width:40px;height:40px;border-radius:10px;background:var(--teal);display:flex;align-items:center;justify-content:center;color:white;font-size:18px;flex-shrink:0"><i class="fas fa-heartbeat"></i></div>
      <div class="widget-q" style="margin:0">${es?'Condiciones de salud':'Health Conditions'}</div>
    </div>
    <div class="widget-qsub">${es?'Al cambiar de plan, es clave asegurarnos de que tus condiciones y medicamentos estén cubiertos.':'When changing plans, it\'s key to ensure your conditions and medications are covered.'}</div>
    ${chronicPanel()}
    ${nextBtn('Continuar','Continue','mv_step4()')}
  `;
}

function mv_step4() { updateWidgetProgress(85);
  wData.chronic = getChecked('chronic');
  renderUrgencyStep('flow-moving', 'moving');
}

// ══════════════════════════════════════════════════
// FLOW 3 — BETTER OPTIONS
// ══════════════════════════════════════════════════
function renderBT_Step1(es) {
  document.getElementById('flow-better').innerHTML = `
    <button class="widget-back" onclick="wBack('w-step-0')"><i class="fas fa-arrow-left"></i> ${es?'Atrás':'Back'}</button>
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
      <div style="width:40px;height:40px;border-radius:10px;background:var(--teal);display:flex;align-items:center;justify-content:center;color:white;font-size:18px;flex-shrink:0"><i class="fas fa-user-friends"></i></div>
      <div class="widget-q" style="margin:0">${es?'¿Para quién buscas opciones?':'Who are you looking for options for?'}</div>
    </div>
    <div class="widget-qsub">${es?'Las preguntas serán ligeramente diferentes según tu respuesta.':'The questions will be slightly different based on your answer.'}</div>
    ${opt('Para mí — yo quiero comparar mi plan actual','For me — I want to compare my current plan',"bt_who('self')")}
    ${opt('Para un familiar (padre, madre, abuelo/a...)','For a family member (parent, grandparent...)',"bt_who('family')")}
  `;
  showWidgetStep('flow-better');
}

function bt_who(who) {
  wData.forWhom = who;
  const es = currentLang === 'es';
  if (who === 'self') {
    shell('flow-better','flow-better','fas fa-balance-scale','var(--teal)',
      '¿Cuál es tu seguro actual?', 'Tell me about your current insurance',
      'Necesito saber el punto de partida para encontrar algo mejor.', 'I need your starting point to find something better.',
      carrierSel('bt-carrier') +
      '<div style="display:grid;grid-template-columns:2fr 1fr;gap:12px;align-items:start">' +
      inp('bt-zip','Tu código postal*','Your zip code*','text','Ej: 90028','E.g. 90028',true) +
      inp('bt-state','Tu estado','Your state','text','CA','CA',false) +
      '</div>' +
      sel('bt-plantype','¿Qué tipo de plan tienes?','What type of plan do you have?',
        `<option value="advantage">${es?'Medicare Advantage (Parte C)':'Medicare Advantage (Part C)'}</option>
         <option value="medigap">${es?'Medicare Original + Suplemento Medigap':'Original Medicare + Medigap Supplement'}</option>
         <option value="original">${es?'Medicare Original solamente':'Original Medicare only'}</option>
         <option value="unknown">${es?'No estoy seguro/a':'Not sure'}</option>`
      ) +
      nextBtn('Continuar','Continue','bt_step2_self()')
    );
    setTimeout(() => {
      const zipEl = document.getElementById('bt-zip');
      const stEl  = document.getElementById('bt-state');
      if (zipEl && stEl) {
        zipEl.addEventListener('input', function() {
          const st = zipToState(this.value);
          if (st && !stEl._touched) { stEl.value = st; stEl.style.color='var(--teal)'; }
        });
        stEl.addEventListener('input', function() { this._touched = true; this.style.color='var(--dark)'; });
      }
    }, 0);
  } else {
    shell('flow-better','flow-better','fas fa-hands-helping','var(--green)',
      '¿Dónde vive tu familiar?', 'Where does your family member live?',
      'Los planes disponibles dependen del área donde viven. También necesito saber un poco sobre ellos.', 'Available plans depend on where they live. I also need to know a little about them.',
      '<div style="display:grid;grid-template-columns:2fr 1fr;gap:12px;align-items:start">' +
      inp('pr-zip','Código postal del familiar*','Family member\'s zip*','text','Ej: 90028','E.g. 90028',true) +
      inp('pr-state','Estado','State','text','CA','CA',false) +
      '</div>' +
      sel('pr-age','¿Qué edad tiene tu familiar?','How old is your family member?',
        `<option value="almost64">${es?'64 años — cumple 65 pronto':'64 years old — turning 65 soon'}</option>
         <option value="65plus_has">${es?'65+ y YA tiene Medicare':'65+ and ALREADY has Medicare'}</option>
         <option value="65plus_no">${es?'65+ pero NO tiene Medicare todavía':'65+ but does NOT have Medicare yet'}</option>
         <option value="disability">${es?'Menos de 65 — califica por discapacidad':'Under 65 — qualifies due to disability'}</option>`
      ) +
      sel('pr-lang','¿Tu familiar habla inglés?','Does your family member speak English?',
        `<option value="es">${es?'Prefiere español':'Prefers Spanish'}</option>
         <option value="en">${es?'Habla inglés bien':'Speaks English well'}</option>
         <option value="both">${es?'Habla los dos idiomas':'Speaks both languages'}</option>`
      ) +
      nextBtn('Continuar','Continue','bt_step2_fam()')
    );
    setTimeout(() => {
      const zipEl = document.getElementById('pr-zip');
      const stEl  = document.getElementById('pr-state');
      if (zipEl && stEl) {
        zipEl.addEventListener('input', function() {
          const st = zipToState(this.value);
          if (st && !stEl._touched) { stEl.value = st; stEl.style.color='var(--teal)'; }
        });
        stEl.addEventListener('input', function() { this._touched = true; this.style.color='var(--dark)'; });
      }
    }, 0);
  }
}

function bt_step2_self() {
  const zip = getVal('bt-zip');
  if (!zip) { document.getElementById('bt-zip').style.borderColor='#DC2626'; return; }
  const carrierEl = document.getElementById('bt-carrier');
  let carrier = carrierEl ? carrierEl.value : '';
  if (carrier === 'other') { const oth = document.getElementById('bt-carrier-other'); carrier = oth ? oth.value.trim() || 'Otra' : 'Otra'; }
  wData.carrier = carrier; wData.zip = zip; wData.state = getVal('bt-state'); wData.plantype = getVal('bt-plantype');
  const es = currentLang === 'es';
  shell('flow-better','flow-better','fas fa-exclamation-circle','var(--teal)',
    '¿Cuál es tu principal queja con tu plan actual?', 'What is your main complaint about your current plan?',
    'Sé específico/a — esto nos ayuda a saber exactamente en qué enfocarnos.', 'Be specific — this helps us know exactly what to focus on.',
    opt('Los costos son muy altos (prima, copagos, deducibles)','Costs are too high (premium, copays, deductibles)',"bt_issue('cost')") +
    opt('Mis médicos ya no están en la red del plan','My doctors are no longer in the plan network',"bt_issue('doctors')") +
    opt('Mis medicamentos cuestan demasiado con este plan','My medications cost too much with this plan',"bt_issue('drugs')") +
    opt('Me falta cobertura dental, visión o auditiva','I am missing dental, vision, or hearing coverage',"bt_issue('extras')") +
    opt('Recibí carta que dice que mi plan cambia o se cancela','I received a letter saying my plan is changing or cancelled',"bt_issue('cancelled')",'¡Actúa rápido!','Act fast!')
  );
}

function bt_step2_fam() {
  const zip = getVal('pr-zip');
  if (!zip) { document.getElementById('pr-zip').style.borderColor='#DC2626'; return; }
  wData.parentZip = zip; wData.parentState = getVal('pr-state');
  wData.parentAge = getVal('pr-age'); wData.parentLang = getVal('pr-lang');
  const es = currentLang === 'es';
  shell('flow-better','flow-better','fas fa-id-card','var(--green)',
    '¿Tu familiar ya tiene Medicare Parte A y Parte B?', 'Does your family member already have Medicare Part A and Part B?',
    'Esto determina si necesitamos inscribirlos o simplemente mejorar su cobertura actual.', 'This determines whether we need to enroll them or just improve their current coverage.',
    partABQuestion() + nextBtn('Continuar','Continue','bt_step3_fam()')
  );
}

function bt_issue(i) {
  wData.issue = i;
  const es = currentLang === 'es';
  shell('flow-better','flow-better','fas fa-id-card','var(--teal)',
    '¿Ya tienes Medicare Parte A y Parte B?', 'Do you already have Medicare Part A and Part B?',
    'Necesitamos confirmarlo para comparar las opciones correctas disponibles en tu área.', 'We need to confirm this to compare the right options available in your area.',
    partABQuestion() + nextBtn('Continuar','Continue','bt_step3_self()')
  );
}

function bt_step3_self() {
  wData.partAB = getVal('partab');
  bt_showChronic('bt_step4()');
}

function bt_step3_fam() {
  wData.partAB = getVal('partab');
  const es = currentLang === 'es';
  shell('flow-better','flow-better','fas fa-question-circle','var(--green)',
    '¿Cuál es la situación de tu familiar ahora mismo?', "What is your family member's situation right now?",
    'Sé específico/a — así sabemos exactamente cómo ayudar.', "Be specific — that's how we know exactly how to help.",
    opt('No tiene Medicare y necesita inscribirse','They do not have Medicare and need to enroll',"bt_sit('enroll')") +
    opt('Tiene Medicare pero el plan es muy caro o cubre mal','They have Medicare but it is too expensive or covers poorly',"bt_sit('change')") +
    opt('Se va a mudar y necesita cambiar de plan','They are moving and need to change plans',"bt_sit('moving')") +
    opt('Recibió una carta confusa de Medicare o su seguro','They received a confusing letter from Medicare or their insurer',"bt_sit('letter')") +
    opt('Queremos entender las opciones desde cero','We want to understand the options from scratch',"bt_sit('education')")
  );
}

function bt_sit(s) {
  wData.situation = s;
  bt_showChronic('bt_step4()');
}

function bt_showChronic(nextFn) {
  const es = currentLang === 'es';
  const isFam = wData.forWhom === 'family';
  const label = isFam ? (es?'Condiciones de salud del familiar':"Family member's health conditions") : (es?'Condiciones de salud':'Health Conditions');
  document.getElementById('flow-better').innerHTML = `
    <button class="widget-back" onclick="wBack('flow-better')"><i class="fas fa-arrow-left"></i> ${es?'Atrás':'Back'}</button>
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
      <div style="width:40px;height:40px;border-radius:10px;background:var(--teal);display:flex;align-items:center;justify-content:center;color:white;font-size:18px;flex-shrink:0"><i class="fas fa-heartbeat"></i></div>
      <div class="widget-q" style="margin:0">${label}</div>
    </div>
    <div class="widget-qsub">${es?'Si hay condiciones crónicas, existen planes C-SNP con beneficios adicionales diseñados exactamente para esa situación.':'If there are chronic conditions, there are C-SNP plans with extra benefits designed exactly for that situation.'}</div>
    ${chronicPanel()}
    ${nextBtn('Continuar','Continue',nextFn)}
  `;
}

function bt_step4() { updateWidgetProgress(85);
  wData.chronic = getChecked('chronic');
  renderUrgencyStep('flow-better', wData.forWhom === 'family' ? 'parent' : 'better');
}

// ══════════════════════════════════════════════════
// CONTACT FORM (final step — all flows)
// ══════════════════════════════════════════════════

// ── URGENCY QUALIFIER (over-qualification step) ──────────────────────────
function renderUrgencyStep(containerId, flow) {
  const es = currentLang === 'es';
  document.getElementById(containerId).innerHTML = `
    <button class="widget-back" onclick="history.go(-1)" style="display:none"></button>
    <div class="widget-q" style="margin-bottom:8px">${es?'Una pregunta más…':'One more question…'}</div>
    <div class="widget-qsub" style="margin-bottom:18px">${es?'Esto nos ayuda a priorizar tu caso correctamente.':'This helps us prioritize your case correctly.'}</div>
    <div style="display:flex;flex-direction:column;gap:10px">
      <button onclick="setUrgency('asap','${containerId}','${flow}')" style="padding:14px 18px;border:2px solid var(--lt-blue);border-radius:10px;background:white;font-size:15px;font-family:inherit;cursor:pointer;color:var(--dark);text-align:left;transition:all 0.15s" onmouseover="this.style.borderColor='var(--green)';this.style.background='var(--lt-mint)'" onmouseout="this.style.borderColor='var(--lt-blue)';this.style.background='white'">
        <strong>${es?'Lo antes posible':'As soon as possible'}</strong><br>
        <span style="font-size:13px;color:var(--gray)">${es?'Necesito inscribirme o cambiar de plan pronto.':'I need to enroll or switch plans soon.'}</span>
      </button>
      <button onclick="setUrgency('3months','${containerId}','${flow}')" style="padding:14px 18px;border:2px solid var(--lt-blue);border-radius:10px;background:white;font-size:15px;font-family:inherit;cursor:pointer;color:var(--dark);text-align:left;transition:all 0.15s" onmouseover="this.style.borderColor='var(--blue)';this.style.background='var(--lt-blue)'" onmouseout="this.style.borderColor='var(--lt-blue)';this.style.background='white'">
        <strong>${es?'En los próximos 1–3 meses':'Within the next 1–3 months'}</strong><br>
        <span style="font-size:13px;color:var(--gray)">${es?'Estoy evaluando mis opciones con tiempo.':'I am evaluating my options with time to spare.'}</span>
      </button>
      <button onclick="setUrgency('exploring','${containerId}','${flow}')" style="padding:14px 18px;border:2px solid var(--lt-blue);border-radius:10px;background:white;font-size:15px;font-family:inherit;cursor:pointer;color:var(--dark);text-align:left;transition:all 0.15s" onmouseover="this.style.borderColor='var(--gray)';this.style.background='var(--lt-gray)'" onmouseout="this.style.borderColor='var(--lt-blue)';this.style.background='white'">
        <strong>${es?'Solo estoy explorando por ahora':'Just exploring for now'}</strong><br>
        <span style="font-size:13px;color:var(--gray)">${es?'No hay prisa. Quiero entender mis opciones primero.':'No rush — I want to understand my options first.'}</span>
      </button>
    </div>
  `;
}
function setUrgency(urgency, containerId, flow) {
  wData.urgency = urgency;
  renderContactForm(containerId, flow);
}

function renderContactForm(containerId, flow) {
  const es = currentLang === 'es';
  const badges = {
    'first-time': { icon:'🚨', lbl_es:'Primera Inscripción Medicare', lbl_en:'First Time Medicare Enrollment' },
    'moving':     { icon:'⚡', lbl_es:'Mudanza — Cambio de Plan', lbl_en:'Moving — Plan Change' },
    'better':     { icon:'🔍', lbl_es:'Comparar / Mejorar Plan', lbl_en:'Compare / Improve Plan' },
    'parent':     { icon:'💚', lbl_es:'Ayudando a un Familiar', lbl_en:'Helping a Family Member' },
  };
  const b = badges[flow] || { icon:'📋', lbl_es:'Consulta', lbl_en:'Consultation' };
  document.getElementById(containerId).innerHTML = `
    <button class="widget-back" onclick="wBack('${containerId}')"><i class="fas fa-arrow-left"></i> ${es?'Atrás':'Back'}</button>
    <div style="background:var(--lt-green);border-radius:var(--radius);padding:16px;margin-bottom:24px;display:flex;align-items:center;gap:12px">
      <i class="fas fa-check-circle" style="color:var(--green);font-size:24px;flex-shrink:0"></i>
      <div>
        <strong style="color:var(--navy);font-size:15px">${b.icon} ${es?b.lbl_es:b.lbl_en}</strong><br>
        <span style="font-size:13px;color:var(--gray)">${es?'Respuestas recibidas. Ahora necesito tus datos para llamarte.':'Answers received. Now I need your info to call you.'}</span>
      </div>
    </div>
    <div class="widget-q" style="margin-bottom:8px">${es?'¿Cómo te llamamos?':'How do we reach you?'}</div>
    <div class="widget-qsub">${es?'Alejandra te llama en español o inglés, como prefieras. Gratis, sin obligación.':'Alejandra will call you in English or Spanish. Free, no obligation.'}</div>
    ${inp('cf-name','Tu nombre completo*','Your full name*','text','Ej: María García','E.g. Maria Garcia',true)}
    ${inp('cf-phone','Tu teléfono*','Your phone number*','tel','Ej: (310) 555-1234','E.g. (310) 555-1234',true)}
    ${sel('cf-contact','¿Cómo prefieres que te contactemos?','How would you like us to reach you?',
      `<option value='sms' selected>${es?'Mensaje de texto (SMS)':'Text message (SMS)'}</option>
       <option value='whatsapp'>${es?'WhatsApp':'WhatsApp'}</option>
       <option value='email'>${es?'Email':'Email'}</option>
       <option value='call'>${es?'Teléfono':'Phone call'}</option>`
    )}
    ${sel('cf-time','Mejor momento para contactarte','Best time to reach you',
      `<option value="morning">${es?'Mañana (9am–12pm)':'Morning (9am–12pm)'}</option>
       <option value="afternoon">${es?'Mediodía (12pm–3pm)':'Afternoon (12pm–3pm)'}</option>
       <option value="evening">${es?'Tarde (3pm–6pm)':'Evening (3pm–6pm)'}</option>
       <option value="anytime">${es?'Cualquier hora':'Any time'}</option>`
    )}
    ${sel('cf-lang','¿Prefieres que te llamemos en...?','Preferred language for the call?',
      `<option value="es">${es?'Español':'Spanish'}</option>
       <option value="en">${es?'Inglés':'English'}</option>
       <option value="both">${es?'Cualquiera está bien':'Either is fine'}</option>`
    )}
    <div style="margin-bottom:20px">
      <label style="display:block;font-size:14px;font-weight:600;color:var(--navy);margin-bottom:6px">${es?'¿Algo más que quieras que sepamos? (opciónal)':'Anything else? (optional)'}</label>
      <textarea id="cf-notes" rows="3" placeholder="${es?'Ej: Tengo Kaiser, quiero mantener a mi doctor. Tomo metformina y lisinopril.':'E.g. I have Kaiser, want to keep my doctor. I take metformin and lisinopril.'}" style="width:100%;padding:13px 16px;border:2px solid var(--lt-gray);border-radius:10px;font-size:15px;font-family:inherit;resize:vertical;outline:none" onfocus="this.style.borderColor='var(--blue)'" onblur="this.style.borderColor='var(--lt-gray)'"></textarea>
    </div>
    <button onclick="submitWidget('${flow}')" class="btn btn-primary" style="width:100%;justify-content:center;font-size:17px;padding:18px">
      <i class="fas fa-paper-plane"></i> ${es?'Enviar — Alejandra me Llamará':'Submit — Alejandra Will Call Me'}
    </button>
    <p style="text-align:center;font-size:13px;color:var(--gray);margin-top:12px">${es?'✓ Gratis &nbsp; ✓ Sin compromiso &nbsp; ✓ Nos llamamos':'✓ Free &nbsp; ✓ No obligation &nbsp; ✓ We call you'}</p>
  `;
}

// ══════════════════════════════════════════════════
// SUBMIT — compose pre-filled email
// ══════════════════════════════════════════════════

// ── SUCCESS STATE ────────────────────────────────────────────
function showSuccessState(containerId) {
  const container = document.getElementById(containerId);
  const isEs = currentLang === 'es';
  container.innerHTML = `
    <div style="text-align:center;padding:40px 20px">
      <div style="color:var(--green);font-size:56px;margin-bottom:20px">✓</div>
      <h3 style="margin-bottom:15px;color:var(--navy);font-size:24px">${isEs ? '¡Solicitud Iniciada!' : 'Request Started!'}</h3>
      <p style="font-size:17px;color:var(--gray);margin-bottom:16px;line-height:1.7">
        ${isEs
          ? 'Se ha abierto su correo. Haga clic en <b>"Enviar"</b> para que Alejandra Brizuela Marcos reciba su mensaje.'
          : 'Your email app has opened. Please click <b>"Send"</b> so Alejandra Brizuela Marcos receives your message.'}
      </p>
      <p style="background:#F0F7F0;padding:14px 18px;border-radius:10px;font-size:15px;color:var(--gray);margin-bottom:24px;line-height:1.6">
        <b>TIP:</b> Agregue <b>alejamedicare@gmail.com</b> a sus contactos para que nuestra respuesta no caiga en SPAM.
      </p>
      <button onclick="location.reload()" class="btn btn-primary" style="justify-content:center">
        ${isEs ? '← Volver al inicio' : '← Back to home'}
      </button>
    </div>`;
}

function submitWidget(flow) {
  const name=getVal('cf-name'), phone=getVal('cf-phone');
  if(!name||!phone){ if(!name)document.getElementById('cf-name').style.borderColor='#DC2626'; if(!phone)document.getElementById('cf-phone').style.borderColor='#DC2626'; return; }
  wData.name=name; wData.phone=phone; wData.contactMethod=getVal('cf-contact'); wData.callTime=getVal('cf-time'); wData.callLang=getVal('cf-lang'); wData.notes=getVal('cf-notes'); wData.flow=flow;
  wData.submittedAt=new Date().toLocaleString('en-US',{timeZone:'America/Los_Angeles'});
  const subject = buildEmailSubject();
  const body = buildEmailBody();
  window.location.href = `mailto:alejamedicare@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
  updateWidgetProgress(100); setTimeout(()=>{ showSuccessState('widget-box'); }, 400);
}

function buildEmailSubject() {
  const fl={'first-time':'🚨 PRIMERA INSCRIPCIÓN','moving':'⚡ MUDANZA','better':'COMPARAR PLAN','parent':'💚 AYUDA FAMILIAR'};
  return `${fl[wData.flow]||'📋 NUEVO LEAD'}: ${wData.name}`;
}

function chronicLabel(v) {
  for(const g of CHRONIC_CONDITIONS){ for(const item of g.items){ if(item.v===v) return item.es; } }
  return v;
}

function buildEmailBody() {
  const ct={'morning':'Mañana 9–12pm','afternoon':'Mediodía 12–3pm','evening':'Tarde 3–6pm','anytime':'Cualquier hora'};
  const cl={'es':'Español','en':'Inglés','both':'Cualquiera'};
  const ab={'both':'Sí, tiene ambas (A y B)','a_only':'Solo Parte A','neither':'No tiene ninguna','unsure':'No sabe'};
  const mv={'moved':'Ya se mudó (últimos 60 días)','30d':'Se muda en 30 días','90d':'Se muda en 1–3 meses','planning':'Solo planificando'};
  const pt={'advantage':'Medicare Advantage (Parte C)','medigap':'Original + Medigap','original':'Original solamente','unknown':'No sabe'};
  const is={'cost':'Costos muy altos','doctors':'Médicos fuera de red','drugs':'Medicamentos muy caros','extras':'Falta dental/visión/auditiva','cancelled':'Plan se cancela/cambia'};
  const ag={'almost64':'64 años — cumple 65 pronto','65plus_has':'65+, ya tiene Medicare','65plus_no':'65+, no tiene Medicare','disability':'Discapacidad'};
  const ps={'enroll':'Necesita inscribirse','change':'Mejorar plan actual','moving':'Se muda','letter':'Carta confusa recibida','education':'Educación desde cero'};
  const fl={'first-time':'Primera Inscripción Medicare','moving':'Mudanza — Cambio de Plan','better':'Comparar / Mejorar Plan','parent':'Ayuda para Familiar'};

  let lines = [
    '═══════════════════════════════════════════════════',
    '      NUEVO LEAD — SUSANA MARCOS LLC',
    '═══════════════════════════════════════════════════',
    '',
    `▸ TIPO:        ${fl[wData.flow]||wData.flow}`,
    `▸ FECHA/HORA:  ${wData.submittedAt}`,
    '',
    '── CONTACTO ────────────────────────────────────────',
    `▸ NOMBRE:      ${wData.name}`,
    `▸ TELÉFONO:    ${wData.phone}`,
    `▸ CONTACTAR:   ${wData.contactMethod||'No especificado'}`,
    `▸ LLAMAR:      ${ct[wData.callTime]||wData.callTime}`,
    `▸ IDIOMA:      ${cl[wData.callLang]||wData.callLang}`,
    '',
    '── SITUACIÓN ───────────────────────────────────────',
  ];

  if (wData.birthday) lines.push(`▸ CUMPLEAÑOS 65: ${wData.birthday.month}/${wData.birthday.year}`);
  if (wData.zip)      lines.push(`▸ ZIP:          ${wData.zip}`);
  if (wData.state)    lines.push(`▸ ESTADO:       ${wData.state}`);
  if (wData.zipFrom)  lines.push(`▸ DE (ZIP):     ${wData.zipFrom}, ${wData.stateFrom||''}`);
  if (wData.zipTo)    lines.push(`▸ A (ZIP):      ${wData.zipTo}, ${wData.stateTo||''}`);
  if (wData.moveWhen) lines.push(`▸ MUDANZA:      ${mv[wData.moveWhen]||wData.moveWhen}`);
  if (wData.partAB)   lines.push(`▸ PARTE A y B:  ${ab[wData.partAB]||wData.partAB}`);
  if (wData.workStatus) lines.push(`▸ TRABAJA:      ${wData.workStatus}`);
  if (wData.plantype) lines.push(`▸ PLAN ACTUAL:  ${pt[wData.plantype]||wData.plantype}`);
  if (wData.carrier)  lines.push(`▸ ASEGURADORA:  ${wData.carrier}`);
  if (wData.issue)    lines.push(`▸ PROBLEMA:     ${is[wData.issue]||wData.issue}`);
  if (wData.meds)     lines.push(`▸ MEDICAMENTOS: ${wData.meds}`);
  if (wData.parentZip)   lines.push(`▸ ZIP FAMILIAR: ${wData.parentZip}, ${wData.parentState||''}`);
  if (wData.parentAge)   lines.push(`▸ EDAD FAMILIAR: ${ag[wData.parentAge]||wData.parentAge}`);
  if (wData.parentLang)  lines.push(`▸ IDIOMA FAM.:  ${cl[wData.parentLang]||wData.parentLang}`);
  if (wData.parentSituation) lines.push(`▸ SITUACIÓN FAM.: ${ps[wData.parentSituation]||wData.parentSituation}`);

  if (wData.chronic && wData.chronic.length > 0 && !wData.chronic.includes('none')) {
    lines.push('');
    lines.push('── CONDICIONES CRÓNICAS ────────────────────────────');
    wData.chronic.forEach(c => lines.push(`  ✓ ${chronicLabel(c)}`));
  }

  if (wData.notes) {
    lines.push('');
    lines.push('── NOTAS DEL CLIENTE ───────────────────────────────');
    lines.push(wData.notes);
  }

  lines.push('');
  lines.push('═══════════════════════════════════════════════════');
  lines.push('Enviado desde medicare-hispano.com');
  return lines.join('\n');
}

function submitSeminar(e) {
  e.preventDefault();
  const name = document.getElementById('sem-name').value.trim();
  const email = document.getElementById('sem-email').value.trim();
  const phone = document.getElementById('sem-phone').value.trim();
  const lang = document.getElementById('sem-lang').value;
  const langLabels = {es:'Español',en:'English',both:'Cualquiera'};
  const es = currentLang === 'es';
  const subject = `INSCRIPCIÓN SEMINARIO: ${name}`;
  const body = [
    '═══════════════════════════════════════════════',
    '   NUEVA INSCRIPCIÓN — SEMINARIO VIRTUAL',
    '═══════════════════════════════════════════════',
    '',
    `▸ NOMBRE: ${name}`,
    `▸ EMAIL: ${email}`,
    `▸ TELEFONO: ${phone || 'No proporcionado'}`,
    `▸ IDIOMA PREFERIDO: ${langLabels[lang]||lang}`,
    `▸ FECHA/HORA: ${new Date().toLocaleString('en-US',{timeZone:'America/Los_Angeles'})}`,
    '',
    'Inscrito desde: medicare-hispano.com',
  ].join('\n');
  window.location.href = `mailto:alejamedicare@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
  setTimeout(() => { showSuccessState('seminar-widget'); }, 400);
}

// Init
updateLang();

// ━━━ SMOOTH SCROLL TO WIDGET ━━━━━━━━━━━━━━━━━━━━━━━━━━
// ━━━ OPTIMIZED SCROLL TO WIDGET ━━━━━━━━━━━━━━━━━━━━━━━━━━
function smoothScrollToWidget() {
  function _pulse() {
    const widget = document.getElementById('widget-box');
    if (!widget) return;
    widget.style.transition = 'all 0.4s ease';
    widget.style.boxShadow = '0 0 40px rgba(0, 123, 64, 0.6)';
    widget.style.transform = 'scale(1.02)';
    setTimeout(() => {
      widget.style.transform = 'scale(1)';
      widget.style.boxShadow = 'var(--shadow-lg)';
    }, 500);
  }
  if (true) { window.location.href='index.html#widget-anchor'; return;
    
    setTimeout(() => {
      const anchor = document.getElementById('widget-anchor');
      if (anchor) anchor.scrollIntoView({ behavior: 'smooth', block: 'center' });
      setTimeout(_pulse, 600);
    }, 150);
  } else {
    const anchor = document.getElementById('widget-anchor');
    if (anchor) anchor.scrollIntoView({ behavior: 'smooth', block: 'center' });
    setTimeout(_pulse, 600);
  }
}

// ━━━ WIDGET PROGRESS BAR ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
function updateWidgetProgress(pct) {
  const fill = document.getElementById('widget-progress-fill');
  if (fill) fill.style.width = Math.min(100, Math.max(0, pct)) + '%';
}

// ━━━ MOBILE STICKY CTA VISIBILITY ━━━━━━━━━━━━━━━━━━━━━
(function() {
  var sticky = null;
  function checkScroll() {
    if (!sticky) sticky = document.getElementById('mobile-sticky-cta');
    if (!sticky) return;
    var hero = document.querySelector('.hero');
    if (!hero) return;
    var heroBottom = hero.getBoundingClientRect().bottom;
    // Only show on home page, after hero scrolls out of view
    if (currentPage === 'home' && heroBottom < 0) {
      sticky.style.display = 'flex';
    } else {
      sticky.style.display = 'none';
    }
  }
  window.addEventListener('scroll', checkScroll, { passive: true });
})();

</script>

</body>
</html>